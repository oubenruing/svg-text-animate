String.prototype.codePointAt||!function(){function e(e){if(null==this)throw TypeError();var t,r=String(this),a=r.length,e=e?Number(e):0;if(!((e=e!=e?0:e)<0||a<=e))return 55296<=(t=r.charCodeAt(e))&&t<=56319&&e+1<a&&56320<=(a=r.charCodeAt(e+1))&&a<=57343?1024*(t-55296)+a-56320+65536:t}var t=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(e){}return r}();t?t(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}();var TINF_OK=0,TINF_DATA_ERROR=-3;function Tree(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function Data(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new Tree,this.dtree=new Tree}var sltree=new Tree,sdtree=new Tree,length_bits=new Uint8Array(30),length_base=new Uint16Array(30),dist_bits=new Uint8Array(30),dist_base=new Uint16Array(30),clcidx=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),code_tree=new Tree,lengths=new Uint8Array(320);function tinf_build_bits_base(e,t,r,a){for(var n,o=0;o<r;++o)e[o]=0;for(o=0;o<30-r;++o)e[o+r]=o/r|0;for(n=a,o=0;o<30;++o)t[o]=n,n+=1<<e[o]}function tinf_build_fixed_trees(e,t){for(var r=0;r<7;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;r<24;++r)e.trans[r]=256+r;for(r=0;r<144;++r)e.trans[24+r]=r;for(r=0;r<8;++r)e.trans[168+r]=280+r;for(r=0;r<112;++r)e.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}var offs=new Uint16Array(16);function tinf_build_tree(e,t,r,a){for(var n,o=0;o<16;++o)e.table[o]=0;for(o=0;o<a;++o)e.table[t[r+o]]++;for(o=n=e.table[0]=0;o<16;++o)offs[o]=n,n+=e.table[o];for(o=0;o<a;++o)t[r+o]&&(e.trans[offs[t[r+o]]++]=o)}function tinf_getbit(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function tinf_read_bits(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var a=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,a+r}function tinf_decode_symbol(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;for(var r=0,a=0,n=0,o=e.tag;a=2*a+(1&o),o>>>=1,r+=t.table[++n],0<=(a-=t.table[n]););return e.tag=o,e.bitcount-=n,t.trans[r+a]}function tinf_decode_trees(e,t,r){for(var a,n=tinf_read_bits(e,5,257),o=tinf_read_bits(e,5,1),s=tinf_read_bits(e,4,4),i=0;i<19;++i)lengths[i]=0;for(i=0;i<s;++i){var u=tinf_read_bits(e,3,0);lengths[clcidx[i]]=u}for(tinf_build_tree(code_tree,lengths,0,19),a=0;a<n+o;){var l=tinf_decode_symbol(e,code_tree);switch(l){case 16:for(var p=lengths[a-1],c=tinf_read_bits(e,2,3);c;--c)lengths[a++]=p;break;case 17:for(c=tinf_read_bits(e,3,3);c;--c)lengths[a++]=0;break;case 18:for(c=tinf_read_bits(e,7,11);c;--c)lengths[a++]=0;break;default:lengths[a++]=l}}tinf_build_tree(t,lengths,0,n),tinf_build_tree(r,lengths,n,o)}function tinf_inflate_block_data(e,t,r){for(;;){var a=tinf_decode_symbol(e,t);if(256===a)return TINF_OK;if(a<256)e.dest[e.destLen++]=a;else for(var n,o=tinf_read_bits(e,length_bits[a-=257],length_base[a]),a=tinf_decode_symbol(e,r),s=n=e.destLen-tinf_read_bits(e,dist_bits[a],dist_base[a]);s<n+o;++s)e.dest[e.destLen++]=e.dest[s]}}function tinf_inflate_uncompressed_block(e){for(var t,r;8<e.bitcount;)e.sourceIndex--,e.bitcount-=8;if((t=256*e.source[e.sourceIndex+1]+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return TINF_DATA_ERROR;for(e.sourceIndex+=4,r=t;r;--r)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,TINF_OK}function tinf_uncompress(e,t){var r,a,n=new Data(e,t);do{switch(r=tinf_getbit(n),tinf_read_bits(n,2,0)){case 0:a=tinf_inflate_uncompressed_block(n);break;case 1:a=tinf_inflate_block_data(n,sltree,sdtree);break;case 2:tinf_decode_trees(n,n.ltree,n.dtree),a=tinf_inflate_block_data(n,n.ltree,n.dtree);break;default:a=TINF_DATA_ERROR}if(a!==TINF_OK)throw new Error("Data error")}while(!r);return n.destLen<n.dest.length?"function"==typeof n.dest.slice?n.dest.slice(0,n.destLen):n.dest.subarray(0,n.destLen):n.dest}tinf_build_fixed_trees(sltree,sdtree),tinf_build_bits_base(length_bits,length_base,4,3),tinf_build_bits_base(dist_bits,dist_base,2,1),length_bits[28]=0,length_base[28]=258;var tinyInflate=tinf_uncompress;function derive(e,t,r,a,n){return Math.pow(1-n,3)*e+3*Math.pow(1-n,2)*n*t+3*(1-n)*Math.pow(n,2)*r+Math.pow(n,3)*a}function BoundingBox(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function Path(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function fail(e){throw new Error(e)}function argument(e,t){e||fail(t)}BoundingBox.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},BoundingBox.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},BoundingBox.prototype.addX=function(e){this.addPoint(e,null)},BoundingBox.prototype.addY=function(e){this.addPoint(null,e)},BoundingBox.prototype.addBezier=function(e,t,r,a,n,o,s,i){var u=[e,t],l=[r,a],p=[n,o],c=[s,i];this.addPoint(e,t),this.addPoint(s,i);for(var h=0;h<=1;h++){var f,d=6*u[h]-12*l[h]+6*p[h],g=-3*u[h]+9*l[h]-9*p[h]+3*c[h],m=3*l[h]-3*u[h];0==g?0==d||0<(f=-m/d)&&f<1&&(0===h&&this.addX(derive(u[h],l[h],p[h],c[h],f)),1===h&&this.addY(derive(u[h],l[h],p[h],c[h],f))):(f=Math.pow(d,2)-4*m*g)<0||(0<(m=(-d+Math.sqrt(f))/(2*g))&&m<1&&(0===h&&this.addX(derive(u[h],l[h],p[h],c[h],m)),1===h&&this.addY(derive(u[h],l[h],p[h],c[h],m))),0<(m=(-d-Math.sqrt(f))/(2*g))&&m<1&&(0===h&&this.addX(derive(u[h],l[h],p[h],c[h],m)),1===h&&this.addY(derive(u[h],l[h],p[h],c[h],m))))}},BoundingBox.prototype.addQuad=function(e,t,r,a,n,o){r=e+2/3*(r-e),a=t+2/3*(a-t);this.addBezier(e,t,r,a,r+1/3*(n-e),a+1/3*(o-t),n,o)},Path.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},Path.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},Path.prototype.curveTo=Path.prototype.bezierCurveTo=function(e,t,r,a,n,o){this.commands.push({type:"C",x1:e,y1:t,x2:r,y2:a,x:n,y:o})},Path.prototype.quadTo=Path.prototype.quadraticCurveTo=function(e,t,r,a){this.commands.push({type:"Q",x1:e,y1:t,x:r,y:a})},Path.prototype.close=Path.prototype.closePath=function(){this.commands.push({type:"Z"})},Path.prototype.extend=function(e){var t;if(e.commands)e=e.commands;else if(e instanceof BoundingBox)return t=e,this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close();Array.prototype.push.apply(this.commands,e)},Path.prototype.getBoundingBox=function(){for(var e=new BoundingBox,t=0,r=0,a=0,n=0,o=0;o<this.commands.length;o++){var s=this.commands[o];switch(s.type){case"M":e.addPoint(s.x,s.y),t=a=s.x,r=n=s.y;break;case"L":e.addPoint(s.x,s.y),a=s.x,n=s.y;break;case"Q":e.addQuad(a,n,s.x1,s.y1,s.x,s.y),a=s.x,n=s.y;break;case"C":e.addBezier(a,n,s.x1,s.y1,s.x2,s.y2,s.x,s.y),a=s.x,n=s.y;break;case"Z":a=t,n=r;break;default:throw new Error("Unexpected path command "+s.type)}}return e.isEmpty()&&e.addPoint(0,0),e},Path.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];"M"===r.type?e.moveTo(r.x,r.y):"L"===r.type?e.lineTo(r.x,r.y):"C"===r.type?e.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?e.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},Path.prototype.toPathData=function(n){function e(){for(var e=arguments,t="",r=0;r<arguments.length;r+=1){var a=e[r];0<=a&&0<r&&(t+=" "),t+=(a=a,Math.round(a)===a?""+Math.round(a):a.toFixed(n))}return t}n=void 0!==n?n:2;for(var t="",r=0;r<this.commands.length;r+=1){var a=this.commands[r];"M"===a.type?t+="M"+e(a.x,a.y):"L"===a.type?t+="L"+e(a.x,a.y):"C"===a.type?t+="C"+e(a.x1,a.y1,a.x2,a.y2,a.x,a.y):"Q"===a.type?t+="Q"+e(a.x1,a.y1,a.x,a.y):"Z"===a.type&&(t+="Z")}return t},Path.prototype.toSVG=function(e){var t=(t='<path d="')+this.toPathData(e)+'"';return this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},Path.prototype.toDOMElement=function(e){var e=this.toPathData(e),t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t};var check={fail:fail,argument:argument,assert:argument},LIMIT16=32768,LIMIT32=2147483648,decode={},encode={},sizeOf={};function constant(e){return function(){return e}}encode.BYTE=function(e){return check.argument(0<=e&&e<=255,"Byte value should be between 0 and 255."),[e]},sizeOf.BYTE=constant(1),encode.CHAR=function(e){return[e.charCodeAt(0)]},sizeOf.CHAR=constant(1),encode.CHARARRAY=function(e){void 0===e&&(e="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],r=0;r<e.length;r+=1)t[r]=e.charCodeAt(r);return t},sizeOf.CHARARRAY=function(e){return void 0===e?0:e.length},encode.USHORT=function(e){return[e>>8&255,255&e]},sizeOf.USHORT=constant(2),encode.SHORT=function(e){return[(e=LIMIT16<=e?-(2*LIMIT16-e):e)>>8&255,255&e]},sizeOf.SHORT=constant(2),encode.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},sizeOf.UINT24=constant(3),encode.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},sizeOf.ULONG=constant(4),encode.LONG=function(e){return[(e=LIMIT32<=e?-(2*LIMIT32-e):e)>>24&255,e>>16&255,e>>8&255,255&e]},sizeOf.LONG=constant(4),encode.FIXED=encode.ULONG,sizeOf.FIXED=sizeOf.ULONG,encode.FWORD=encode.SHORT,sizeOf.FWORD=sizeOf.SHORT,encode.UFWORD=encode.USHORT,sizeOf.UFWORD=sizeOf.USHORT,encode.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},sizeOf.LONGDATETIME=constant(8),encode.TAG=function(e){return check.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},sizeOf.TAG=constant(4),encode.Card8=encode.BYTE,sizeOf.Card8=sizeOf.BYTE,encode.Card16=encode.USHORT,sizeOf.Card16=sizeOf.USHORT,encode.OffSize=encode.BYTE,sizeOf.OffSize=sizeOf.BYTE,encode.SID=encode.USHORT,sizeOf.SID=sizeOf.USHORT,encode.NUMBER=function(e){return-107<=e&&e<=107?[e+139]:108<=e&&e<=1131?[247+((e-=108)>>8),255&e]:-1131<=e&&e<=-108?[251+((e=-e-108)>>8),255&e]:-32768<=e&&e<=32767?encode.NUMBER16(e):encode.NUMBER32(e)},sizeOf.NUMBER=function(e){return encode.NUMBER(e).length},encode.NUMBER16=function(e){return[28,e>>8&255,255&e]},sizeOf.NUMBER16=constant(3),encode.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},sizeOf.NUMBER32=constant(5),encode.REAL=function(e){for(var t=e.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t),a=(r&&(r=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length)),t=(Math.round(e*r)/r).toString()),""),n=0,o=t.length;n<o;n+=1){var s=t[n];a+="e"===s?"-"===t[++n]?"c":"b":"."===s?"a":"-"===s?"e":s}for(var i=[30],u=0,l=(a+=1&a.length?"f":"ff").length;u<l;u+=2)i.push(parseInt(a.substr(u,2),16));return i},sizeOf.REAL=function(e){return encode.REAL(e).length},encode.NAME=encode.CHARARRAY,sizeOf.NAME=sizeOf.CHARARRAY,encode.STRING=encode.CHARARRAY,sizeOf.STRING=sizeOf.CHARARRAY,decode.UTF8=function(e,t,r){for(var a=[],n=r,o=0;o<n;o++,t+=1)a[o]=e.getUint8(t);return String.fromCharCode.apply(null,a)},decode.UTF16=function(e,t,r){for(var a=[],n=r/2,o=0;o<n;o++,t+=2)a[o]=e.getUint16(t);return String.fromCharCode.apply(null,a)},encode.UTF16=function(e){for(var t=[],r=0;r<e.length;r+=1){var a=e.charCodeAt(r);t[t.length]=a>>8&255,t[t.length]=255&a}return t},sizeOf.UTF16=function(e){return 2*e.length};var macEncodingCacheKeys,eightBitMacEncodings={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"},macEncodingTableCache=(decode.MACSTRING=function(e,t,r,a){var n=eightBitMacEncodings[a];if(void 0!==n){for(var o="",s=0;s<r;s++){var i=e.getUint8(t+s);o+=i<=127?String.fromCharCode(i):n[127&i]}return o}},"function"==typeof WeakMap&&new WeakMap),getMacEncodingTable=function(e){if(!macEncodingCacheKeys)for(var t in macEncodingCacheKeys={},eightBitMacEncodings)macEncodingCacheKeys[t]=new String(t);var r=macEncodingCacheKeys[e];if(void 0!==r){if(macEncodingTableCache){var a=macEncodingTableCache.get(r);if(void 0!==a)return a}var n=eightBitMacEncodings[e];if(void 0!==n){for(var o={},s=0;s<n.length;s++)o[n.charCodeAt(s)]=s+128;return macEncodingTableCache&&macEncodingTableCache.set(r,o),o}}};function isByteEncodable(e){return-128<=e&&e<=127}function encodeVarDeltaRunAsZeroes(e,t,r){for(var a=0,n=e.length;t<n&&a<64&&0===e[t];)++t,++a;return r.push(128|a-1),t}function encodeVarDeltaRunAsBytes(e,t,r){for(var a=0,n=e.length,o=t;o<n&&a<64;){var s=e[o];if(!isByteEncodable(s))break;if(0===s&&o+1<n&&0===e[o+1])break;++o,++a}r.push(a-1);for(var i=t;i<o;++i)r.push(e[i]+256&255);return o}function encodeVarDeltaRunAsWords(e,t,r){for(var a=0,n=e.length,o=t;o<n&&a<64;){var s=e[o];if(0===s)break;if(isByteEncodable(s)&&o+1<n&&isByteEncodable(e[o+1]))break;++o,++a}r.push(64|a-1);for(var i=t;i<o;++i){var u=e[i];r.push(u+65536>>8&255,u+256&255)}return o}encode.MACSTRING=function(e,t){var r=getMacEncodingTable(t);if(void 0!==r){for(var a=[],n=0;n<e.length;n++){var o=e.charCodeAt(n);if(128<=o&&void 0===(o=r[o]))return;a[n]=o}return a}},sizeOf.MACSTRING=function(e,t){e=encode.MACSTRING(e,t);return void 0!==e?e.length:0},encode.VARDELTAS=function(e){for(var t=0,r=[];t<e.length;)var a=e[t],t=(0===a?encodeVarDeltaRunAsZeroes:-128<=a&&a<=127?encodeVarDeltaRunAsBytes:encodeVarDeltaRunAsWords)(e,t,r);return r},encode.INDEX=function(e){for(var t=1,r=[t],a=[],n=0;n<e.length;n+=1){var o=encode.OBJECT(e[n]);Array.prototype.push.apply(a,o),t+=o.length,r.push(t)}if(0===a.length)return[0,0];for(var s=[],i=1+Math.floor(Math.log(t)/Math.log(2))/8|0,u=[void 0,encode.BYTE,encode.USHORT,encode.UINT24,encode.ULONG][i],l=0;l<r.length;l+=1){var p=u(r[l]);Array.prototype.push.apply(s,p)}return Array.prototype.concat(encode.Card16(e.length),encode.OffSize(i),s,a)},sizeOf.INDEX=function(e){return encode.INDEX(e).length},encode.DICT=function(e){for(var t=[],r=Object.keys(e),a=r.length,n=0;n<a;n+=1){var o=parseInt(r[n],0),s=e[o];t=(t=t.concat(encode.OPERAND(s.value,s.type))).concat(encode.OPERATOR(o))}return t},sizeOf.DICT=function(e){return encode.DICT(e).length},encode.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},encode.OPERAND=function(e,t){var r=[];if(Array.isArray(t))for(var a=0;a<t.length;a+=1)check.argument(e.length===t.length,"Not enough arguments given for type"+t),r=r.concat(encode.OPERAND(e[a],t[a]));else if("SID"===t)r=r.concat(encode.NUMBER(e));else if("offset"===t)r=r.concat(encode.NUMBER32(e));else if("number"===t)r=r.concat(encode.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);r=r.concat(encode.REAL(e))}return r},encode.OP=encode.BYTE,sizeOf.OP=sizeOf.BYTE;var wmm="function"==typeof WeakMap&&new WeakMap;function Table(e,t,r){if(t.length&&("coverageFormat"!==t[0].name||1===t[0].value))for(var a=0;a<t.length;a+=1){var n=t[a];this[n.name]=n.value}if(this.tableName=e,this.fields=t,r)for(var o=Object.keys(r),s=0;s<o.length;s+=1){var i=o[s],u=r[i];void 0!==this[i]&&(this[i]=u)}}function ushortList(e,t,r){void 0===r&&(r=t.length);var a=new Array(t.length+1);a[0]={name:e+"Count",type:"USHORT",value:r};for(var n=0;n<t.length;n++)a[n+1]={name:e+n,type:"USHORT",value:t[n]};return a}function tableList(e,t,r){var a=t.length,n=new Array(a+1);n[0]={name:e+"Count",type:"USHORT",value:a};for(var o=0;o<a;o++)n[o+1]={name:e+o,type:"TABLE",value:r(t[o],o)};return n}function recordList(e,t,r){var a=t.length,n=[];n[0]={name:e+"Count",type:"USHORT",value:a};for(var o=0;o<a;o++)n=n.concat(r(t[o],o));return n}function Coverage(e){1===e.format?Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(ushortList("glyph",e.glyphs))):2===e.format?Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(recordList("rangeRecord",e.ranges,function(e){return[{name:"startGlyphID",type:"USHORT",value:e.start},{name:"endGlyphID",type:"USHORT",value:e.end},{name:"startCoverageIndex",type:"USHORT",value:e.index}]}))):check.assert(!1,"Coverage format must be 1 or 2.")}function ScriptList(e){Table.call(this,"scriptListTable",recordList("scriptRecord",e,function(e,t){var r=e.script,a=r.defaultLangSys;return check.assert(!!a,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new Table("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Table("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:a.reqFeatureIndex}].concat(ushortList("featureIndex",a.featureIndexes)))}].concat(recordList("langSys",r.langSysRecords,function(e,t){var r=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new Table("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(ushortList("featureIndex",r.featureIndexes)))}]})))}]}))}function FeatureList(e){Table.call(this,"featureListTable",recordList("featureRecord",e,function(e,t){var r=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new Table("featureTable",[{name:"featureParams",type:"USHORT",value:r.featureParams}].concat(ushortList("lookupListIndex",r.lookupListIndexes)))}]}))}function LookupList(e,r){Table.call(this,"lookupListTable",tableList("lookup",e,function(e){var t=r[e.lookupType];return check.assert(!!t,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new Table("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(tableList("subtable",e.subtables,t)))}))}encode.CHARSTRING=function(e){if(wmm){var t=wmm.get(e);if(void 0!==t)return t}for(var r=[],a=e.length,n=0;n<a;n+=1)var o=e[n],r=r.concat(encode[o.type](o.value));return wmm&&wmm.set(e,r),r},sizeOf.CHARSTRING=function(e){return encode.CHARSTRING(e).length},encode.OBJECT=function(e){var t=encode[e.type];return check.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},sizeOf.OBJECT=function(e){var t=sizeOf[e.type];return check.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},encode.TABLE=function(e){for(var t=[],r=e.fields.length,a=[],n=[],o=0;o<r;o+=1){var s=e.fields[o],i=encode[s.type],u=(check.argument(void 0!==i,"No encoding function for field type "+s.type+" ("+s.name+")"),e[s.name]),i=i(u=void 0===u?s.value:u);"TABLE"===s.type?(n.push(t.length),t=t.concat([0,0]),a.push(i)):t=t.concat(i)}for(var l=0;l<a.length;l+=1){var p=n[l],c=t.length;check.argument(c<65536,"Table "+e.tableName+" too big."),t[p]=c>>8,t[p+1]=255&c,t=t.concat(a[l])}return t},sizeOf.TABLE=function(e){for(var t=0,r=e.fields.length,a=0;a<r;a+=1){var n=e.fields[a],o=sizeOf[n.type],s=(check.argument(void 0!==o,"No sizeOf function for field type "+n.type+" ("+n.name+")"),e[n.name]);t+=o(s=void 0===s?n.value:s),"TABLE"===n.type&&(t+=2)}return t},encode.RECORD=encode.TABLE,sizeOf.RECORD=sizeOf.TABLE,encode.LITERAL=function(e){return e},sizeOf.LITERAL=function(e){return e.length},Table.prototype.encode=function(){return encode.TABLE(this)},Table.prototype.sizeOf=function(){return sizeOf.TABLE(this)},Coverage.prototype=Object.create(Table.prototype),Coverage.prototype.constructor=Coverage,ScriptList.prototype=Object.create(Table.prototype),ScriptList.prototype.constructor=ScriptList,FeatureList.prototype=Object.create(Table.prototype),FeatureList.prototype.constructor=FeatureList,LookupList.prototype=Object.create(Table.prototype);var table={Table:Table,Record:Table,Coverage:Coverage,ScriptList:ScriptList,FeatureList:FeatureList,LookupList:LookupList.prototype.constructor=LookupList,ushortList:ushortList,tableList:tableList,recordList:recordList};function getByte(e,t){return e.getUint8(t)}function getUShort(e,t){return e.getUint16(t,!1)}function getShort(e,t){return e.getInt16(t,!1)}function getULong(e,t){return e.getUint32(t,!1)}function getFixed(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}function getTag(e,t){for(var r="",a=t;a<t+4;a+=1)r+=String.fromCharCode(e.getInt8(a));return r}function getOffset(e,t,r){for(var a=0,n=0;n<r;n+=1)a=(a<<=8)+e.getUint8(t+n);return a}function getBytes(e,t,r){for(var a=[],n=t;n<r;n+=1)a.push(e.getUint8(n));return a}function bytesToString(e){for(var t="",r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return t}var typeOffsets={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Parser(e,t){this.data=e,this.offset=t,this.relativeOffset=0}Parser.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},Parser.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},Parser.prototype.parseCard8=Parser.prototype.parseByte,Parser.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},Parser.prototype.parseCard16=Parser.prototype.parseUShort,Parser.prototype.parseSID=Parser.prototype.parseUShort,Parser.prototype.parseOffset16=Parser.prototype.parseUShort,Parser.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},Parser.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},Parser.prototype.parseULong=function(){var e=getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},Parser.prototype.parseOffset32=Parser.prototype.parseULong,Parser.prototype.parseFixed=function(){var e=getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},Parser.prototype.parseString=function(e){var t=this.data,r=this.offset+this.relativeOffset,a="";this.relativeOffset+=e;for(var n=0;n<e;n++)a+=String.fromCharCode(t.getUint8(r+n));return a},Parser.prototype.parseTag=function(){return this.parseString(4)},Parser.prototype.parseLongDateTime=function(){var e=getULong(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},Parser.prototype.parseVersion=function(e){var t=getUShort(this.data,this.offset+this.relativeOffset),r=getUShort(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+r/(e=void 0===e?4096:e)/10},Parser.prototype.skip=function(e,t){this.relativeOffset+=typeOffsets[e]*(t=void 0===t?1:t)},Parser.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getUint32(a),a+=4;return this.relativeOffset+=4*e,t},Parser.prototype.parseOffset16List=Parser.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getUint16(a),a+=2;return this.relativeOffset+=2*e,t},Parser.prototype.parseShortList=function(e){for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getInt16(a),a+=2;return this.relativeOffset+=2*e,t},Parser.prototype.parseByteList=function(e){for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getUint8(a++);return this.relativeOffset+=e,t},Parser.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),a=0;a<e;a++)r[a]=t.call(this);return r},Parser.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),a=0;a<e;a++)r[a]=t.call(this);return r},Parser.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),a=Object.keys(t),n=0;n<e;n++){for(var o={},s=0;s<a.length;s++){var i=a[s],u=t[i];o[i]=u.call(this)}r[n]=o}return r},Parser.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),a=Object.keys(t),n=0;n<e;n++){for(var o={},s=0;s<a.length;s++){var i=a[s],u=t[i];o[i]=u.call(this)}r[n]=o}return r},Parser.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),r={},a=0;a<t.length;a++){var n=t[a],o=e[n];r[n]=o.call(this)}return r},Parser.prototype.parseValueRecord=function(e){var t;if(0!==(e=void 0===e?this.parseUShort():e))return t={},1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t},Parser.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),r=new Array(t),a=0;a<t;a++)r[a]=this.parseValueRecord(e);return r},Parser.prototype.parsePointer=function(e){var t=this.parseOffset16();if(0<t)return new Parser(this.data,this.offset+t).parseStruct(e)},Parser.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(0<t)return new Parser(this.data,this.offset+t).parseStruct(e)},Parser.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),r=t.length,a=this.relativeOffset,n=new Array(r),o=0;o<r;o++){var s=t[o];if(0===s)n[o]=void 0;else if(this.relativeOffset=s,e){for(var i=this.parseOffset16List(),u=new Array(i.length),l=0;l<i.length;l++)this.relativeOffset=s+i[l],u[l]=e.call(this);n[o]=u}else n[o]=this.parseUShortList()}return this.relativeOffset=a,n},Parser.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),r=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(r)};if(2!==t)throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.");for(var a=new Array(r),n=0;n<r;n++)a[n]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:a}},Parser.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:Parser.uShort,end:Parser.uShort,classId:Parser.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},Parser.list=function(e,t){return function(){return this.parseList(e,t)}},Parser.list32=function(e,t){return function(){return this.parseList32(e,t)}},Parser.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},Parser.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},Parser.pointer=function(e){return function(){return this.parsePointer(e)}},Parser.pointer32=function(e){return function(){return this.parsePointer32(e)}},Parser.tag=Parser.prototype.parseTag,Parser.byte=Parser.prototype.parseByte,Parser.uShort=Parser.offset16=Parser.prototype.parseUShort,Parser.uShortList=Parser.prototype.parseUShortList,Parser.uLong=Parser.offset32=Parser.prototype.parseULong,Parser.uLongList=Parser.prototype.parseULongList,Parser.struct=Parser.prototype.parseStruct,Parser.coverage=Parser.prototype.parseCoverage,Parser.classDef=Parser.prototype.parseClassDef;var langSysTable={reserved:Parser.uShort,reqFeatureIndex:Parser.uShort,featureIndexes:Parser.uShortList},parse=(Parser.prototype.parseScriptList=function(){return this.parsePointer(Parser.recordList({tag:Parser.tag,script:Parser.pointer({defaultLangSys:Parser.pointer(langSysTable),langSysRecords:Parser.recordList({tag:Parser.tag,langSys:Parser.pointer(langSysTable)})})}))||[]},Parser.prototype.parseFeatureList=function(){return this.parsePointer(Parser.recordList({tag:Parser.tag,feature:Parser.pointer({featureParams:Parser.offset16,lookupListIndexes:Parser.uShortList})}))||[]},Parser.prototype.parseLookupList=function(a){return this.parsePointer(Parser.list(Parser.pointer(function(){var e=this.parseUShort(),t=(check.argument(1<=e&&e<=9,"GPOS/GSUB lookup type "+e+" unknown."),this.parseUShort()),r=16&t;return{lookupType:e,lookupFlag:t,subtables:this.parseList(Parser.pointer(a[e])),markFilteringSet:r?this.parseUShort():void 0}})))||[]},Parser.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var e=this.parseUShort(),t=this.parseUShort();return check.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:Parser.offset32,featureTableSubstitutionOffset:Parser.offset32})})||[]},{getByte:getByte,getCard8:getByte,getUShort:getUShort,getCard16:getUShort,getShort:getShort,getULong:getULong,getFixed:getFixed,getTag:getTag,getOffset:getOffset,getBytes:getBytes,bytesToString:bytesToString,Parser:Parser});function parseCmapTableFormat12(e,t){var r;t.parseUShort(),e.length=t.parseULong(),e.language=t.parseULong(),e.groupCount=r=t.parseULong(),e.glyphIndexMap={};for(var a=0;a<r;a+=1)for(var n=t.parseULong(),o=t.parseULong(),s=t.parseULong(),i=n;i<=o;i+=1)e.glyphIndexMap[i]=s,s++}function parseCmapTableFormat4(e,t,r,a,n){e.length=t.parseUShort(),e.language=t.parseUShort(),e.segCount=o=t.parseUShort()>>1,t.skip("uShort",3),e.glyphIndexMap={};for(var o,s=new parse.Parser(r,a+n+14),i=new parse.Parser(r,a+n+16+2*o),u=new parse.Parser(r,a+n+16+4*o),l=new parse.Parser(r,a+n+16+6*o),p=a+n+16+8*o,c=0;c<o-1;c+=1)for(var h=void 0,f=s.parseUShort(),d=i.parseUShort(),g=u.parseShort(),m=l.parseUShort(),v=d;v<=f;v+=1)0!==m?(p=(p=l.offset+l.relativeOffset-2)+m+2*(v-d),0!==(h=parse.getUShort(r,p))&&(h=h+g&65535)):h=v+g&65535,e.glyphIndexMap[v]=h}function parseCmapTable(e,t){for(var r={},a=(r.version=parse.getUShort(e,t),check.argument(0===r.version,"cmap table version should be 0."),r.numTables=parse.getUShort(e,t+2),-1),n=r.numTables-1;0<=n;--n){var o=parse.getUShort(e,t+4+8*n),s=parse.getUShort(e,t+4+8*n+2);if(3===o&&(0===s||1===s||10===s)||0===o&&(0===s||1===s||2===s||3===s||4===s)){a=parse.getULong(e,t+4+8*n+4);break}}if(-1===a)throw new Error("No valid cmap sub-tables found.");var i=new parse.Parser(e,t+a);if(r.format=i.parseUShort(),12===r.format)parseCmapTableFormat12(r,i);else{if(4!==r.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");parseCmapTableFormat4(r,i,e,t,a)}return r}function addSegment(e,t,r){e.segments.push({end:t,start:t,delta:-(t-r),offset:0,glyphIndex:r})}function addTerminatorSegment(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}function makeCmapTable(e){for(var t=!0,r=e.length-1;0<r;--r)if(65535<e.get(r).unicode){console.log("Adding CMAP format 12 (needed!)"),t=!1;break}var a=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:t?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:t?12:20}],n=(a=(a=t?a:a.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])).concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),new table.Table("cmap",a));for(n.segments=[],r=0;r<e.length;r+=1){for(var o=e.get(r),s=0;s<o.unicodes.length;s+=1)addSegment(n,o.unicodes[s],r);n.segments=n.segments.sort(function(e,t){return e.start-t.start})}addTerminatorSegment(n);var i=n.segments.length,u=0,l=[],p=[],c=[],h=[],f=[],d=[];for(r=0;r<i;r+=1){var g=n.segments[r];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+r,type:"USHORT",value:g.end}),p=p.concat({name:"start_"+r,type:"USHORT",value:g.start}),c=c.concat({name:"idDelta_"+r,type:"SHORT",value:g.delta}),h=h.concat({name:"idRangeOffset_"+r,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(f=f.concat({name:"glyph_"+r,type:"USHORT",value:g.glyphId}))):u+=1,t||void 0===g.glyphIndex||(d=(d=(d=d.concat({name:"cmap12Start_"+r,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+r,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+r,type:"ULONG",value:g.glyphIndex}))}return n.segCountX2=2*(i-u),n.searchRange=2*Math.pow(2,Math.floor(Math.log(i-u)/Math.log(2))),n.entrySelector=Math.log(n.searchRange/2)/Math.log(2),n.rangeShift=n.segCountX2-n.searchRange,n.fields=n.fields.concat(l),n.fields.push({name:"reservedPad",type:"USHORT",value:0}),n.fields=n.fields.concat(p),n.fields=n.fields.concat(c),n.fields=n.fields.concat(h),n.fields=n.fields.concat(f),n.cmap4Length=14+2*l.length+2+2*p.length+2*c.length+2*h.length+2*f.length,t||(a=16+4*d.length,n.cmap12Offset=20+n.cmap4Length,n.fields=n.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:a},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:d.length/3}]),n.fields=n.fields.concat(d)),n}var cmap={parse:parseCmapTable,make:makeCmapTable},cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function DefaultEncoding(e){this.font=e}function CmapEncoding(e){this.cmap=e}function CffEncoding(e,t){this.encoding=e,this.charset=t}function GlyphNames(e){switch(e.version){case 1:this.names=standardNames.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<standardNames.length?this.names[t]=standardNames[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-standardNames.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var r=0;r<e.numberOfGlyphs;r++)this.names[r]=standardNames[r+e.glyphNameIndex[r]];break;default:this.names=[]}}function addGlyphNamesAll(e){for(var t=e.tables.cmap.glyphIndexMap,r=Object.keys(t),a=0;a<r.length;a+=1){var n,o=r[a],s=t[o];(n=e.glyphs.get(s)).addUnicode(parseInt(o))}for(var i=0;i<e.glyphs.length;i+=1)n=e.glyphs.get(i),e.cffEncoding?e.isCIDFont?n.name="gid"+i:n.name=e.cffEncoding.charset[i]:e.glyphNames.names&&(n.name=e.glyphNames.glyphIndexToName(i))}function addGlyphNamesToUnicodeMap(e){e._IndexToUnicodeMap={};for(var t=e.tables.cmap.glyphIndexMap,r=Object.keys(t),a=0;a<r.length;a+=1){var n=r[a],o=t[n];void 0===e._IndexToUnicodeMap[o]?e._IndexToUnicodeMap[o]={unicodes:[parseInt(n)]}:e._IndexToUnicodeMap[o].unicodes.push(parseInt(n))}}function addGlyphNames(e,t){(t.lowMemory?addGlyphNamesToUnicodeMap:addGlyphNamesAll)(e)}function line(e,t,r,a,n){e.beginPath(),e.moveTo(t,r),e.lineTo(a,n),e.stroke()}DefaultEncoding.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),r=this.font.glyphs;if(r)for(var a=0;a<r.length;a+=1)for(var n=r.get(a),o=0;o<n.unicodes.length;o+=1)if(n.unicodes[o]===t)return a;return null},CmapEncoding.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},CffEncoding.prototype.charToGlyphIndex=function(e){e=e.codePointAt(0),e=this.encoding[e];return this.charset.indexOf(e)},GlyphNames.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},GlyphNames.prototype.glyphIndexToName=function(e){return this.names[e]};var draw={line:line};function getPathDefinition(e,t){var r=t||new Path;return{configurable:!0,get:function(){return r="function"==typeof r?r():r},set:function(e){r=e}}}function Glyph(e){this.bindConstructorValues(e)}function defineDependentProperty(t,e,r){Object.defineProperty(t,e,{get:function(){return t.path,t[r]},set:function(e){t[r]=e},enumerable:!0,configurable:!0})}function GlyphSet(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++){var a=t[r];a.path.unitsPerEm=e.unitsPerEm,this.glyphs[r]=a}this.length=t&&t.length||0}function glyphLoader(e,t){return new Glyph({index:t,font:e})}function ttfGlyphLoader(r,e,a,n,o,s){return function(){var t=new Glyph({index:e,font:r});return t.path=function(){a(t,n,o);var e=s(r.glyphs,t);return e.unitsPerEm=r.unitsPerEm,e},defineDependentProperty(t,"xMin","_xMin"),defineDependentProperty(t,"xMax","_xMax"),defineDependentProperty(t,"yMin","_yMin"),defineDependentProperty(t,"yMax","_yMax"),t}}function cffGlyphLoader(r,e,a,n){return function(){var t=new Glyph({index:e,font:r});return t.path=function(){var e=a(r,t,n);return e.unitsPerEm=r.unitsPerEm,e},t}}Glyph.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],"xMin"in e&&(this.xMin=e.xMin),"yMin"in e&&(this.yMin=e.yMin),"xMax"in e&&(this.xMax=e.xMax),"yMax"in e&&(this.yMax=e.yMax),"advanceWidth"in e&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",getPathDefinition(this,e.path))},Glyph.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},Glyph.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},Glyph.prototype.getPath=function(e,t,r,a,n){e=void 0!==e?e:0,t=void 0!==t?t:0,r=void 0!==r?r:72;for(var o,s,i=(a=a||{}).xScale,u=a.yScale,l=((o=a.hinting&&n&&n.hinting?this.path&&n.hinting.exec(this,r):o)?(s=n.hinting.getCommands(o),e=Math.round(e),t=Math.round(t),i=u=1):(s=this.path.commands,a=1/(this.path.unitsPerEm||1e3)*r,void 0===i&&(i=a),void 0===u&&(u=a)),new Path),p=0;p<s.length;p+=1){var c=s[p];"M"===c.type?l.moveTo(e+c.x*i,t+-c.y*u):"L"===c.type?l.lineTo(e+c.x*i,t+-c.y*u):"Q"===c.type?l.quadraticCurveTo(e+c.x1*i,t+-c.y1*u,e+c.x*i,t+-c.y*u):"C"===c.type?l.curveTo(e+c.x1*i,t+-c.y1*u,e+c.x2*i,t+-c.y2*u,e+c.x*i,t+-c.y*u):"Z"===c.type&&l.closePath()}return l},Glyph.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],r=0;r<this.points.length;r+=1){var a=this.points[r];t.push(a),a.lastPointOfContour&&(e.push(t),t=[])}return check.argument(0===t.length,"There are still points left in the current contour."),e},Glyph.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],r=[],a=0;a<e.length;a+=1){var n=e[a];"Z"!==n.type&&(t.push(n.x),r.push(n.y)),"Q"!==n.type&&"C"!==n.type||(t.push(n.x1),r.push(n.y1)),"C"===n.type&&(t.push(n.x2),r.push(n.y2))}var o={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},Glyph.prototype.draw=function(e,t,r,a,n){this.getPath(t,r,a,n).draw(e)},Glyph.prototype.drawPoints=function(o,e,t,r){function a(e,t,r,a){o.beginPath();for(var n=0;n<e.length;n+=1)o.moveTo(t+e[n].x*a,r+e[n].y*a),o.arc(t+e[n].x*a,r+e[n].y*a,2,0,2*Math.PI,!1);o.closePath(),o.fill()}e=void 0!==e?e:0,t=void 0!==t?t:0;for(var r=1/this.path.unitsPerEm*(r=void 0!==r?r:24),n=[],s=[],i=this.path,u=0;u<i.commands.length;u+=1){var l=i.commands[u];void 0!==l.x&&n.push({x:l.x,y:-l.y}),void 0!==l.x1&&s.push({x:l.x1,y:-l.y1}),void 0!==l.x2&&s.push({x:l.x2,y:-l.y2})}o.fillStyle="blue",a(n,e,t,r),o.fillStyle="red",a(s,e,t,r)},Glyph.prototype.drawMetrics=function(e,t,r,a){t=void 0!==t?t:0,r=void 0!==r?r:0,a=1/this.path.unitsPerEm*(a=void 0!==a?a:24),e.lineWidth=1,e.strokeStyle="black",draw.line(e,t,-1e4,t,1e4),draw.line(e,-1e4,r,1e4,r);var n=this.xMin||0,o=this.yMin||0,s=this.xMax||0,i=this.yMax||0,u=this.advanceWidth||0;e.strokeStyle="blue",draw.line(e,t+n*a,-1e4,t+n*a,1e4),draw.line(e,t+s*a,-1e4,t+s*a,1e4),draw.line(e,-1e4,r+-o*a,1e4,r+-o*a),draw.line(e,-1e4,r+-i*a,1e4,r+-i*a),e.strokeStyle="green",draw.line(e,t+u*a,-1e4,t+u*a,1e4)},GlyphSet.prototype.get=function(e){if(void 0===this.glyphs[e]){this.font._push(e),"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());var t=this.glyphs[e],r=this.font._IndexToUnicodeMap[e];if(r)for(var a=0;a<r.unicodes.length;a++)t.addUnicode(r.unicodes[a]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+e:t.name=this.font.cffEncoding.charset[e]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(e)),this.glyphs[e].advanceWidth=this.font._hmtxTableData[e].advanceWidth,this.glyphs[e].leftSideBearing=this.font._hmtxTableData[e].leftSideBearing}else"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());return this.glyphs[e]},GlyphSet.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var glyphset={GlyphSet:GlyphSet,glyphLoader:glyphLoader,ttfGlyphLoader:ttfGlyphLoader,cffGlyphLoader:cffGlyphLoader};function equals(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(!equals(e[r],t[r]))return!1;return!0}return!1}function calcCFFSubroutineBias(e){e=e.length<1240?107:e.length<33900?1131:32768;return e}function parseCFFIndex(e,t,r){var a,n=[],o=[],s=parse.getCard16(e,t);if(0!==s){for(var i=parse.getByte(e,t+2),u=t+(s+1)*i+2,l=t+3,p=0;p<s+1;p+=1)n.push(parse.getOffset(e,l,i)),l+=i;a=u+n[s]}else a=t+2;for(var c=0;c<n.length-1;c+=1){var h=parse.getBytes(e,u+n[c],u+n[c+1]);r&&(h=r(h)),o.push(h)}return{objects:o,startOffset:t,endOffset:a}}function parseCFFIndexLowMemory(e,t){var r=[],a=parse.getCard16(e,t);if(0!==a){for(var n=parse.getByte(e,t+2),o=t+(a+1)*n+2,s=t+3,i=0;i<a+1;i+=1)r.push(parse.getOffset(e,s,n)),s+=n;o=o+r[a]}else o=t+2;return{offsets:r,startOffset:t,endOffset:o}}function getCffIndexObject(e,t,r,a,n){var o=parse.getCard16(r,a),s=0,o=(0!==o&&(s=a+(o+1)*parse.getByte(r,a+2)+2),parse.getBytes(r,s+t[e],s+t[e+1]));return o=n?n(o):o}function parseFloatOperand(e){for(var t="",r=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var a=e.parseByte(),n=a>>4,a=15&a;if(15==n)break;if(t+=r[n],15==a)break;t+=r[a]}return parseFloat(t)}function parseOperand(e,t){if(28===t)return e.parseByte()<<8|e.parseByte();if(29===t)return e.parseByte()<<24|e.parseByte()<<16|e.parseByte()<<8|e.parseByte();if(30===t)return parseFloatOperand(e);if(32<=t&&t<=246)return t-139;if(247<=t&&t<=250)return 256*(t-247)+e.parseByte()+108;if(251<=t&&t<=254)return 256*-(t-251)-e.parseByte()-108;throw new Error("Invalid b0 "+t)}function entriesToObject(e){for(var t={},r=0;r<e.length;r+=1){var a=e[r][0],n=e[r][1],o=void 0,o=1===n.length?n[0]:n;if(t.hasOwnProperty(a)&&!isNaN(t[a]))throw new Error("Object "+t+" already has key "+a);t[a]=o}return t}function parseCFFDict(e,t,r){var a=new parse.Parser(e,t=void 0!==t?t:0),n=[],o=[];for(r=void 0!==r?r:e.length;a.relativeOffset<r;){var s=a.parseByte();s<=21?(12===s&&(s=1200+a.parseByte()),n.push([s,o]),o=[]):o.push(parseOperand(a,s))}return entriesToObject(n)}function getCFFString(e,t){return t=t<=390?cffStandardStrings[t]:e[t-391]}function interpretDict(e,t,r){for(var a,n={},o=0;o<t.length;o+=1){var s=t[o];if(Array.isArray(s.type)){var i=[];i.length=s.type.length;for(var u=0;u<s.type.length;u++)void 0===(a=void 0!==e[s.op]?e[s.op][u]:void 0)&&(a=void 0!==s.value&&void 0!==s.value[u]?s.value[u]:null),"SID"===s.type[u]&&(a=getCFFString(r,a)),i[u]=a;n[s.name]=i}else void 0===(a=e[s.op])&&(a=void 0!==s.value?s.value:null),"SID"===s.type&&(a=getCFFString(r,a)),n[s.name]=a}return n}function parseCFFHeader(e,t){var r={};return r.formatMajor=parse.getCard8(e,t),r.formatMinor=parse.getCard8(e,t+1),r.size=parse.getCard8(e,t+2),r.offsetSize=parse.getCard8(e,t+3),r.startOffset=t,r.endOffset=t+4,r}var TOP_DICT_META=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],PRIVATE_DICT_META=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function parseCFFTopDict(e,t){return interpretDict(parseCFFDict(e,0,e.byteLength),TOP_DICT_META,t)}function parseCFFPrivateDict(e,t,r,a){return interpretDict(parseCFFDict(e,t,r),PRIVATE_DICT_META,a)}function gatherCFFTopDicts(e,t,r,a){for(var n=[],o=0;o<r.length;o+=1){var s=parseCFFTopDict(new DataView(new Uint8Array(r[o]).buffer),a),i=(s._subrs=[],s._subrsBias=0,s._defaultWidthX=0,s._nominalWidthX=0,s.private[0]),u=s.private[1];0!==i&&0!==u&&(i=parseCFFPrivateDict(e,u+t,i,a),s._defaultWidthX=i.defaultWidthX,s._nominalWidthX=i.nominalWidthX,0!==i.subrs&&(u=parseCFFIndex(e,u+i.subrs+t),s._subrs=u.objects,s._subrsBias=calcCFFSubroutineBias(s._subrs)),s._privateDict=i),n.push(s)}return n}function parseCFFCharset(e,t,r,a){var n=new parse.Parser(e,t),o=(--r,[".notdef"]),e=n.parseCard8();if(0===e)for(var s=0;s<r;s+=1)i=n.parseSID(),o.push(getCFFString(a,i));else if(1===e)for(;o.length<=r;)for(var i=n.parseSID(),u=n.parseCard8(),l=0;l<=u;l+=1)o.push(getCFFString(a,i)),i+=1;else{if(2!==e)throw new Error("Unknown charset format "+e);for(;o.length<=r;){i=n.parseSID(),u=n.parseCard16();for(var p=0;p<=u;p+=1)o.push(getCFFString(a,i)),i+=1}}return o}function parseCFFEncoding(e,t,r){var a={},n=new parse.Parser(e,t),e=n.parseCard8();if(0===e)for(var o=n.parseCard8(),s=0;s<o;s+=1)a[u=n.parseCard8()]=s;else{if(1!==e)throw new Error("Unknown encoding format "+e);for(var i=n.parseCard8(),u=1,l=0;l<i;l+=1)for(var p=n.parseCard8(),c=n.parseCard8(),h=p;h<=p+c;h+=1)a[h]=u,u+=1}return new CffEncoding(a,r)}function parseCFFCharstring(m,v,e){var y,b,S,T,t,x,k,r,P,C=new Path,U=[],R=0,O=!1,E=!1,L=0,D=0,F=(P=(m.isCIDFont?(t=m.tables.cff.topDict._fdSelect[v.index],t=m.tables.cff.topDict._fdArray[t],x=t._subrs,k=t._subrsBias,r=t._defaultWidthX,t):(x=m.tables.cff.topDict._subrs,k=m.tables.cff.topDict._subrsBias,r=m.tables.cff.topDict._defaultWidthX,m.tables.cff.topDict))._nominalWidthX,r);function I(e,t){E&&C.closePath(),C.moveTo(e,t),E=!0}function M(){U.length%2==0||O||(F=U.shift()+P),R+=U.length>>1,U.length=0,O=!0}return function e(t){for(var r,a,n,o,s,i,u,l,p,c,h,f,d=0;d<t.length;){var g=t[d];switch(d+=1,g){case 1:case 3:M();break;case 4:1<U.length&&!O&&(F=U.shift()+P,O=!0),D+=U.pop(),I(L,D);break;case 5:for(;0<U.length;)L+=U.shift(),D+=U.shift(),C.lineTo(L,D);break;case 6:for(;0<U.length&&(L+=U.shift(),C.lineTo(L,D),0!==U.length);)D+=U.shift(),C.lineTo(L,D);break;case 7:for(;0<U.length&&(D+=U.shift(),C.lineTo(L,D),0!==U.length);)L+=U.shift(),C.lineTo(L,D);break;case 8:for(;0<U.length;)y=L+U.shift(),b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),L=S+U.shift(),D=T+U.shift(),C.curveTo(y,b,S,T,L,D);break;case 10:s=U.pop()+k,(i=x[s])&&e(i);break;case 11:return;case 12:switch(g=t[d],d+=1,g){case 35:y=L+U.shift(),b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),u=S+U.shift(),l=T+U.shift(),p=u+U.shift(),c=l+U.shift(),h=p+U.shift(),f=c+U.shift(),L=h+U.shift(),D=f+U.shift(),U.shift(),C.curveTo(y,b,S,T,u,l),C.curveTo(p,c,h,f,L,D);break;case 34:y=L+U.shift(),b=D,S=y+U.shift(),T=b+U.shift(),u=S+U.shift(),l=T,p=u+U.shift(),c=T,h=p+U.shift(),f=D,L=h+U.shift(),C.curveTo(y,b,S,T,u,l),C.curveTo(p,c,h,f,L,D);break;case 36:y=L+U.shift(),b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),u=S+U.shift(),l=T,p=u+U.shift(),c=T,h=p+U.shift(),f=c+U.shift(),L=h+U.shift(),C.curveTo(y,b,S,T,u,l),C.curveTo(p,c,h,f,L,D);break;case 37:y=L+U.shift(),b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),u=S+U.shift(),l=T+U.shift(),p=u+U.shift(),c=l+U.shift(),h=p+U.shift(),f=c+U.shift(),Math.abs(h-L)>Math.abs(f-D)?L=h+U.shift():D=f+U.shift(),C.curveTo(y,b,S,T,u,l),C.curveTo(p,c,h,f,L,D);break;default:console.log("Glyph "+v.index+": unknown operator 1200"+g),U.length=0}break;case 14:0<U.length&&!O&&(F=U.shift()+P,O=!0),E&&(C.closePath(),E=!1);break;case 18:M();break;case 19:case 20:M(),d+=R+7>>3;break;case 21:2<U.length&&!O&&(F=U.shift()+P,O=!0),D+=U.pop(),I(L+=U.pop(),D);break;case 22:1<U.length&&!O&&(F=U.shift()+P,O=!0),I(L+=U.pop(),D);break;case 23:M();break;case 24:for(;2<U.length;)y=L+U.shift(),b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),L=S+U.shift(),D=T+U.shift(),C.curveTo(y,b,S,T,L,D);L+=U.shift(),D+=U.shift(),C.lineTo(L,D);break;case 25:for(;6<U.length;)L+=U.shift(),D+=U.shift(),C.lineTo(L,D);y=L+U.shift(),b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),L=S+U.shift(),D=T+U.shift(),C.curveTo(y,b,S,T,L,D);break;case 26:for(U.length%2&&(L+=U.shift());0<U.length;)y=L,b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),L=S,D=T+U.shift(),C.curveTo(y,b,S,T,L,D);break;case 27:for(U.length%2&&(D+=U.shift());0<U.length;)y=L+U.shift(),b=D,S=y+U.shift(),T=b+U.shift(),L=S+U.shift(),D=T,C.curveTo(y,b,S,T,L,D);break;case 28:r=t[d],a=t[d+1],U.push((r<<24|a<<16)>>16),d+=2;break;case 29:s=U.pop()+m.gsubrsBias,(i=m.gsubrs[s])&&e(i);break;case 30:for(;0<U.length&&(y=L,b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),L=S+U.shift(),D=T+(1===U.length?U.shift():0),C.curveTo(y,b,S,T,L,D),0!==U.length);)y=L+U.shift(),b=D,S=y+U.shift(),T=b+U.shift(),D=T+U.shift(),L=S+(1===U.length?U.shift():0),C.curveTo(y,b,S,T,L,D);break;case 31:for(;0<U.length&&(y=L+U.shift(),b=D,S=y+U.shift(),T=b+U.shift(),D=T+U.shift(),L=S+(1===U.length?U.shift():0),C.curveTo(y,b,S,T,L,D),0!==U.length);)y=L,b=D+U.shift(),S=y+U.shift(),T=b+U.shift(),L=S+U.shift(),D=T+(1===U.length?U.shift():0),C.curveTo(y,b,S,T,L,D);break;default:g<32?console.log("Glyph "+v.index+": unknown operator "+g):g<247?U.push(g-139):g<251?(r=t[d],d+=1,U.push(256*(g-247)+r+108)):g<255?(r=t[d],d+=1,U.push(256*-(g-251)-r-108)):(r=t[d],a=t[d+1],n=t[d+2],o=t[d+3],d+=4,U.push((r<<24|a<<16|n<<8|o)/65536))}}}(e),v.advanceWidth=F,C}function parseCFFFDSelect(e,t,r,a){var n,o=[],s=new parse.Parser(e,t),e=s.parseCard8();if(0===e)for(var i=0;i<r;i++){if(a<=(n=s.parseCard8()))throw new Error("CFF table CID Font FDSelect has bad FD index value "+n+" (FD count "+a+")");o.push(n)}else{if(3!==e)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+e);var u,l=s.parseCard16(),p=s.parseCard16();if(0!==p)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+p);for(var c=0;c<l;c++){if(n=s.parseCard8(),u=s.parseCard16(),a<=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+n+" (FD count "+a+")");if(r<u)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+u);for(;p<u;p++)o.push(n);p=u}if(u!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+u)}return o}function parseCFFTable(r,a,n,e){n.tables.cff={};var t=parseCFFHeader(r,a),t=parseCFFIndex(r,t.endOffset,parse.bytesToString),t=parseCFFIndex(r,t.endOffset),o=parseCFFIndex(r,t.endOffset,parse.bytesToString),s=parseCFFIndex(r,o.endOffset),s=(n.gsubrs=s.objects,n.gsubrsBias=calcCFFSubroutineBias(n.gsubrs),gatherCFFTopDicts(r,a,t.objects,o.objects));if(1!==s.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+s.length);var i=s[0];if((n.tables.cff.topDict=i)._privateDict&&(n.defaultWidthX=i._privateDict.defaultWidthX,n.nominalWidthX=i._privateDict.nominalWidthX),void 0!==i.ros[0]&&void 0!==i.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){t=i.fdArray,s=i.fdSelect;if(0===t||0===s)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");t=parseCFFIndex(r,t+=a),t=gatherCFFTopDicts(r,a,t.objects,o.objects);i._fdArray=t,i._fdSelect=parseCFFFDSelect(r,s+=a,n.numGlyphs,t.length)}var u,s=a+i.private[1],t=parseCFFPrivateDict(r,s,i.private[0],o.objects),s=(n.defaultWidthX=t.defaultWidthX,n.nominalWidthX=t.nominalWidthX,0!==t.subrs?(s=s+t.subrs,t=parseCFFIndex(r,s),n.subrs=t.objects,n.subrsBias=calcCFFSubroutineBias(n.subrs)):(n.subrs=[],n.subrsBias=0),e.lowMemory?(u=parseCFFIndexLowMemory(r,a+i.charStrings),n.nGlyphs=u.offsets.length):(u=parseCFFIndex(r,a+i.charStrings),n.nGlyphs=u.objects.length),parseCFFCharset(r,a+i.charset,n.nGlyphs,o.objects));if(0===i.encoding?n.cffEncoding=new CffEncoding(cffStandardEncoding,s):1===i.encoding?n.cffEncoding=new CffEncoding(cffExpertEncoding,s):n.cffEncoding=parseCFFEncoding(r,a+i.encoding,s),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new glyphset.GlyphSet(n),e.lowMemory)n._push=function(e){var t=getCffIndexObject(e,u.offsets,r,a+i.charStrings);n.glyphs.push(e,glyphset.cffGlyphLoader(n,e,parseCFFCharstring,t))};else for(var l=0;l<n.nGlyphs;l+=1){var p=u.objects[l];n.glyphs.push(l,glyphset.cffGlyphLoader(n,l,parseCFFCharstring,p))}}function encodeString(e,t){var r,a=cffStandardStrings.indexOf(e);return 0<=a&&(r=a),0<=(a=t.indexOf(e))?r=a+cffStandardStrings.length:(r=cffStandardStrings.length+t.length,t.push(e)),r}function makeHeader(){return new table.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function makeNameIndex(e){var t=new table.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<e.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:e[r]});return t}function makeDict(e,t,r){for(var a={},n=0;n<e.length;n+=1){var o=e[n],s=t[o.name];void 0===s||equals(s,o.value)||("SID"===o.type&&(s=encodeString(s,r)),a[o.op]={name:o.name,type:o.type,value:s})}return a}function makeTopDict(e,t){var r=new table.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=makeDict(TOP_DICT_META,e,t),r}function makeTopDictIndex(e){var t=new table.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function makeStringIndex(e){var t=new table.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<e.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:e[r]});return t}function makeGlobalSubrIndex(){return new table.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function makeCharsets(e,t){for(var r=new table.Record("Charsets",[{name:"format",type:"Card8",value:0}]),a=0;a<e.length;a+=1){var n=encodeString(e[a],t);r.fields.push({name:"glyph_"+a,type:"SID",value:n})}return r}function glyphToOps(e){for(var t=[],r=e.path,a=(t.push({name:"width",type:"NUMBER",value:e.advanceWidth}),0),n=0,o=0;o<r.commands.length;o+=1){var s,i,u,l,p=void 0,c=void 0,h=r.commands[o];"Q"===h.type&&(h={type:"C",x:h.x,y:h.y,x1:Math.round(1/3*a+2/3*h.x1),y1:Math.round(1/3*n+2/3*h.y1),x2:Math.round(1/3*h.x+2/3*h.x1),y2:Math.round(1/3*h.y+2/3*h.y1)}),"M"===h.type?(p=Math.round(h.x-a),c=Math.round(h.y-n),t.push({name:"dx",type:"NUMBER",value:p}),t.push({name:"dy",type:"NUMBER",value:c}),t.push({name:"rmoveto",type:"OP",value:21}),a=Math.round(h.x),n=Math.round(h.y)):"L"===h.type?(p=Math.round(h.x-a),c=Math.round(h.y-n),t.push({name:"dx",type:"NUMBER",value:p}),t.push({name:"dy",type:"NUMBER",value:c}),t.push({name:"rlineto",type:"OP",value:5}),a=Math.round(h.x),n=Math.round(h.y)):"C"===h.type&&(s=Math.round(h.x1-a),i=Math.round(h.y1-n),u=Math.round(h.x2-h.x1),l=Math.round(h.y2-h.y1),p=Math.round(h.x-h.x2),c=Math.round(h.y-h.y2),t.push({name:"dx1",type:"NUMBER",value:s}),t.push({name:"dy1",type:"NUMBER",value:i}),t.push({name:"dx2",type:"NUMBER",value:u}),t.push({name:"dy2",type:"NUMBER",value:l}),t.push({name:"dx",type:"NUMBER",value:p}),t.push({name:"dy",type:"NUMBER",value:c}),t.push({name:"rrcurveto",type:"OP",value:8}),a=Math.round(h.x),n=Math.round(h.y))}return t.push({name:"endchar",type:"OP",value:14}),t}function makeCharStringsIndex(e){for(var t=new table.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<e.length;r+=1){var a=e.get(r),n=glyphToOps(a);t.charStrings.push({name:a.name,type:"CHARSTRING",value:n})}return t}function makePrivateDict(e,t){var r=new table.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=makeDict(PRIVATE_DICT_META,e,t),r}function makeCFFTable(e,t){for(var r,a=new table.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),n=1/t.unitsPerEm,n={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[n,0,0,n,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},o=[],s=1;s<e.length;s+=1)r=e.get(s),o.push(r.name);var i=[],t=(a.header=makeHeader(),a.nameIndex=makeNameIndex([t.postScriptName]),makeTopDict(n,i)),u=(a.topDictIndex=makeTopDictIndex(t),a.globalSubrIndex=makeGlobalSubrIndex(),a.charsets=makeCharsets(o,i),a.charStringsIndex=makeCharStringsIndex(e),a.privateDict=makePrivateDict({},i),a.stringIndex=makeStringIndex(i),a.header.sizeOf()+a.nameIndex.sizeOf()+a.topDictIndex.sizeOf()+a.stringIndex.sizeOf()+a.globalSubrIndex.sizeOf());return n.charset=u,n.encoding=0,n.charStrings=n.charset+a.charsets.sizeOf(),n.private[1]=n.charStrings+a.charStringsIndex.sizeOf(),t=makeTopDict(n,i),a.topDictIndex=makeTopDictIndex(t),a}var cff={parse:parseCFFTable,make:makeCFFTable};function parseHeadTable(e,t){var r={},e=new parse.Parser(e,t);return r.version=e.parseVersion(),r.fontRevision=Math.round(1e3*e.parseFixed())/1e3,r.checkSumAdjustment=e.parseULong(),r.magicNumber=e.parseULong(),check.argument(1594834165===r.magicNumber,"Font header has wrong magic number."),r.flags=e.parseUShort(),r.unitsPerEm=e.parseUShort(),r.created=e.parseLongDateTime(),r.modified=e.parseLongDateTime(),r.xMin=e.parseShort(),r.yMin=e.parseShort(),r.xMax=e.parseShort(),r.yMax=e.parseShort(),r.macStyle=e.parseUShort(),r.lowestRecPPEM=e.parseUShort(),r.fontDirectionHint=e.parseShort(),r.indexToLocFormat=e.parseShort(),r.glyphDataFormat=e.parseShort(),r}function makeHeadTable(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,r=t;return e.createdTimestamp&&(r=e.createdTimestamp+2082844800),new table.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}var head={parse:parseHeadTable,make:makeHeadTable};function parseHheaTable(e,t){var r={},e=new parse.Parser(e,t);return r.version=e.parseVersion(),r.ascender=e.parseShort(),r.descender=e.parseShort(),r.lineGap=e.parseShort(),r.advanceWidthMax=e.parseUShort(),r.minLeftSideBearing=e.parseShort(),r.minRightSideBearing=e.parseShort(),r.xMaxExtent=e.parseShort(),r.caretSlopeRise=e.parseShort(),r.caretSlopeRun=e.parseShort(),r.caretOffset=e.parseShort(),e.relativeOffset+=8,r.metricDataFormat=e.parseShort(),r.numberOfHMetrics=e.parseUShort(),r}function makeHheaTable(e){return new table.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}var hhea={parse:parseHheaTable,make:makeHheaTable};function parseHmtxTableAll(e,t,r,a,n){for(var o,s,i=new parse.Parser(e,t),u=0;u<a;u+=1){u<r&&(o=i.parseUShort(),s=i.parseShort());var l=n.get(u);l.advanceWidth=o,l.leftSideBearing=s}}function parseHmtxTableOnLowMemory(e,t,r,a,n){e._hmtxTableData={};for(var o,s,i=new parse.Parser(t,r),u=0;u<n;u+=1)u<a&&(o=i.parseUShort(),s=i.parseShort()),e._hmtxTableData[u]={advanceWidth:o,leftSideBearing:s}}function parseHmtxTable(e,t,r,a,n,o,s){s.lowMemory?parseHmtxTableOnLowMemory(e,t,r,a,n):parseHmtxTableAll(t,r,a,n,o)}function makeHmtxTable(e){for(var t=new table.Table("hmtx",[]),r=0;r<e.length;r+=1){var a=e.get(r),n=a.advanceWidth||0,a=a.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:n}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:a})}return t}var hmtx={parse:parseHmtxTable,make:makeHmtxTable};function makeLtagTable(e){for(var t=new table.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),r="",a=12+4*e.length,n=0;n<e.length;++n){var o=r.indexOf(e[n]);o<0&&(o=r.length,r+=e[n]),t.fields.push({name:"offset "+n,type:"USHORT",value:a+o}),t.fields.push({name:"length "+n,type:"USHORT",value:e[n].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t}function parseLtagTable(e,t){for(var r=new parse.Parser(e,t),a=r.parseULong(),n=(check.argument(1===a,"Unsupported ltag table version."),r.skip("uLong",1),r.parseULong()),o=[],s=0;s<n;s++){for(var i="",u=t+r.parseUShort(),l=r.parseUShort(),p=u;p<u+l;++p)i+=String.fromCharCode(e.getInt8(p));o.push(i)}return o}var ltag={make:makeLtagTable,parse:parseLtagTable};function parseMaxpTable(e,t){var r={},e=new parse.Parser(e,t);return r.version=e.parseVersion(),r.numGlyphs=e.parseUShort(),1===r.version&&(r.maxPoints=e.parseUShort(),r.maxContours=e.parseUShort(),r.maxCompositePoints=e.parseUShort(),r.maxCompositeContours=e.parseUShort(),r.maxZones=e.parseUShort(),r.maxTwilightPoints=e.parseUShort(),r.maxStorage=e.parseUShort(),r.maxFunctionDefs=e.parseUShort(),r.maxInstructionDefs=e.parseUShort(),r.maxStackElements=e.parseUShort(),r.maxSizeOfInstructions=e.parseUShort(),r.maxComponentElements=e.parseUShort(),r.maxComponentDepth=e.parseUShort()),r}function makeMaxpTable(e){return new table.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}var maxp={parse:parseMaxpTable,make:makeMaxpTable},nameTableNames=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],macLanguages={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},macLanguageToScript={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},windowsLanguages={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function getLanguageCode(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return macLanguages[t];case 3:return windowsLanguages[t]}}var utf16="utf-16",macScriptEncodings={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},macLanguageEncodings={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function getEncoding(e,t,r){switch(e){case 0:return utf16;case 1:return macLanguageEncodings[r]||macScriptEncodings[t];case 3:if(1===t||10===t)return utf16}}function parseNameTable(e,t,r){for(var a={},n=new parse.Parser(e,t),t=n.parseUShort(),o=n.parseUShort(),s=n.offset+n.parseUShort(),i=0;i<o;i++){var u=n.parseUShort(),l=n.parseUShort(),p=n.parseUShort(),c=n.parseUShort(),c=nameTableNames[c]||c,h=n.parseUShort(),f=n.parseUShort(),d=getLanguageCode(u,p,r),u=getEncoding(u,l,p);void 0!==u&&void 0!==d&&(l=void 0,(l=u===utf16?decode.UTF16(e,s+f,h):decode.MACSTRING(e,s+f,h,u))&&((p=void 0===(p=a[c])?a[c]={}:p)[d]=l))}return 1===t&&n.parseUShort(),a}function reverseDict(e){var t,r={};for(t in e)r[e[t]]=parseInt(t);return r}function makeNameRecord(e,t,r,a,n,o){return new table.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:a},{name:"length",type:"USHORT",value:n},{name:"offset",type:"USHORT",value:o}])}function findSubArray(e,t){var r=e.length,a=t.length-r+1;e:for(var n=0;n<a;n++)for(;n<a;n++){for(var o=0;o<r;o++)if(t[n+o]!==e[o])continue e;return n}return-1}function addStringToPool(e,t){if((r=findSubArray(e,t))<0)for(var r=t.length,a=0,n=e.length;a<n;++a)t.push(e[a]);return r}function makeNameTable(e,t){var r,a=[],n={},o=reverseDict(nameTableNames);for(r in e){var s=o[r];if(void 0===s&&(s=r),h=parseInt(s),isNaN(h))throw new Error('Name table entry "'+r+'" does not exist, see nameTableNames for complete list.');n[h]=e[r],a.push(h)}for(var i=reverseDict(macLanguages),u=reverseDict(windowsLanguages),l=[],p=[],c=0;c<a.length;c++){var h,f,d=n[h=a[c]];for(f in d){var g=d[f],m=1,v=i[f],y=macLanguageToScript[v],b=getEncoding(m,y,v),b=encode.MACSTRING(g,b),S=(void 0===b&&(m=0,(v=t.indexOf(f))<0&&(v=t.length,t.push(f)),y=4,b=encode.UTF16(g)),addStringToPool(b,p)),m=(l.push(makeNameRecord(m,y,v,h,b.length,S)),u[f]);void 0!==m&&(v=addStringToPool(y=encode.UTF16(g),p),l.push(makeNameRecord(3,1,m,h,y.length,v)))}}l.sort(function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID});for(var T=new table.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:l.length},{name:"stringOffset",type:"USHORT",value:6+12*l.length}]),x=0;x<l.length;x++)T.fields.push({name:"record_"+x,type:"RECORD",value:l[x]});return T.fields.push({name:"strings",type:"LITERAL",value:p}),T}var _name={parse:parseNameTable,make:makeNameTable},unicodeRanges=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function getUnicodeRange(e){for(var t=0;t<unicodeRanges.length;t+=1){var r=unicodeRanges[t];if(e>=r.begin&&e<r.end)return t}return-1}function parseOS2Table(e,t){var r={},a=new parse.Parser(e,t);r.version=a.parseUShort(),r.xAvgCharWidth=a.parseShort(),r.usWeightClass=a.parseUShort(),r.usWidthClass=a.parseUShort(),r.fsType=a.parseUShort(),r.ySubscriptXSize=a.parseShort(),r.ySubscriptYSize=a.parseShort(),r.ySubscriptXOffset=a.parseShort(),r.ySubscriptYOffset=a.parseShort(),r.ySuperscriptXSize=a.parseShort(),r.ySuperscriptYSize=a.parseShort(),r.ySuperscriptXOffset=a.parseShort(),r.ySuperscriptYOffset=a.parseShort(),r.yStrikeoutSize=a.parseShort(),r.yStrikeoutPosition=a.parseShort(),r.sFamilyClass=a.parseShort(),r.panose=[];for(var n=0;n<10;n++)r.panose[n]=a.parseByte();return r.ulUnicodeRange1=a.parseULong(),r.ulUnicodeRange2=a.parseULong(),r.ulUnicodeRange3=a.parseULong(),r.ulUnicodeRange4=a.parseULong(),r.achVendID=String.fromCharCode(a.parseByte(),a.parseByte(),a.parseByte(),a.parseByte()),r.fsSelection=a.parseUShort(),r.usFirstCharIndex=a.parseUShort(),r.usLastCharIndex=a.parseUShort(),r.sTypoAscender=a.parseShort(),r.sTypoDescender=a.parseShort(),r.sTypoLineGap=a.parseShort(),r.usWinAscent=a.parseUShort(),r.usWinDescent=a.parseUShort(),1<=r.version&&(r.ulCodePageRange1=a.parseULong(),r.ulCodePageRange2=a.parseULong()),2<=r.version&&(r.sxHeight=a.parseShort(),r.sCapHeight=a.parseShort(),r.usDefaultChar=a.parseUShort(),r.usBreakChar=a.parseUShort(),r.usMaxContent=a.parseUShort()),r}function makeOS2Table(e){return new table.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}var os2={parse:parseOS2Table,make:makeOS2Table,unicodeRanges:unicodeRanges,getUnicodeRange:getUnicodeRange};function parsePostTable(e,t){var r={},a=new parse.Parser(e,t);switch(r.version=a.parseVersion(),r.italicAngle=a.parseFixed(),r.underlinePosition=a.parseShort(),r.underlineThickness=a.parseShort(),r.isFixedPitch=a.parseULong(),r.minMemType42=a.parseULong(),r.maxMemType42=a.parseULong(),r.minMemType1=a.parseULong(),r.maxMemType1=a.parseULong(),r.version){case 1:r.names=standardNames.slice();break;case 2:r.numberOfGlyphs=a.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var n=0;n<r.numberOfGlyphs;n++)r.glyphNameIndex[n]=a.parseUShort();r.names=[];for(var o,s=0;s<r.numberOfGlyphs;s++)r.glyphNameIndex[s]>=standardNames.length&&(o=a.parseChar(),r.names.push(a.parseString(o)));break;case 2.5:r.numberOfGlyphs=a.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var i=0;i<r.numberOfGlyphs;i++)r.offset[i]=a.parseChar()}return r}function makePostTable(){return new table.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var post={parse:parsePostTable,make:makePostTable},subtableParsers=new Array(9),lookupRecordDesc=(subtableParsers[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(Parser.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(Parser.coverage),substitute:this.parseOffset16List()}:void check.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},subtableParsers[2]=function(){var e=this.parseUShort();return check.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Parser.coverage),sequences:this.parseListOfLists()}},subtableParsers[3]=function(){var e=this.parseUShort();return check.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Parser.coverage),alternateSets:this.parseListOfLists()}},subtableParsers[4]=function(){var e=this.parseUShort();return check.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Parser.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}},{sequenceIndex:Parser.uShort,lookupListIndex:Parser.uShort});function parseGsubTable(e,t){e=new Parser(e,t=t||0),t=e.parseVersion(1);return check.argument(1===t||1.1===t,"Unsupported GSUB table version."),1===t?{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(subtableParsers)}:{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(subtableParsers),variations:e.parseFeatureVariationsList()}}subtableParsers[5]=function(){var e,t,r=this.offset+this.relativeOffset,a=this.parseUShort();return 1===a?{substFormat:a,coverage:this.parsePointer(Parser.coverage),ruleSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,lookupRecordDesc)}})}:2===a?{substFormat:a,coverage:this.parsePointer(Parser.coverage),classDef:this.parsePointer(Parser.classDef),classSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,lookupRecordDesc)}})}:3===a?(e=this.parseUShort(),t=this.parseUShort(),{substFormat:a,coverages:this.parseList(e,Parser.pointer(Parser.coverage)),lookupRecords:this.parseRecordList(t,lookupRecordDesc)}):void check.assert(!1,"0x"+r.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},subtableParsers[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(Parser.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})}:2===t?{substFormat:2,coverage:this.parsePointer(Parser.coverage),backtrackClassDef:this.parsePointer(Parser.classDef),inputClassDef:this.parsePointer(Parser.classDef),lookaheadClassDef:this.parsePointer(Parser.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})}:3===t?{substFormat:3,backtrackCoverage:this.parseList(Parser.pointer(Parser.coverage)),inputCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookaheadCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookupRecords:this.parseRecordList(lookupRecordDesc)}:void check.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},subtableParsers[7]=function(){var e=this.parseUShort(),e=(check.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1"),this.parseUShort()),t=new Parser(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:subtableParsers[e].call(t)}},subtableParsers[8]=function(){var e=this.parseUShort();return check.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Parser.coverage),backtrackCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookaheadCoverage:this.parseList(Parser.pointer(Parser.coverage)),substitutes:this.parseUShortList()}};var subtableMakers=new Array(9);function makeGsubTable(e){return new table.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new table.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new table.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new table.LookupList(e.lookups,subtableMakers)}])}subtableMakers[1]=function(e){return 1===e.substFormat?new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new table.Coverage(e.coverage)}].concat(table.ushortList("substitute",e.substitute)))},subtableMakers[2]=function(e){return check.assert(1===e.substFormat,"Lookup type 2 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(e.coverage)}].concat(table.tableList("seqSet",e.sequences,function(e){return new table.Table("sequenceSetTable",table.ushortList("sequence",e))})))},subtableMakers[3]=function(e){return check.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(e.coverage)}].concat(table.tableList("altSet",e.alternateSets,function(e){return new table.Table("alternateSetTable",table.ushortList("alternate",e))})))},subtableMakers[4]=function(e){return check.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(e.coverage)}].concat(table.tableList("ligSet",e.ligatureSets,function(e){return new table.Table("ligatureSetTable",table.tableList("ligature",e,function(e){return new table.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(table.ushortList("component",e.components,e.components.length+1)))}))})))},subtableMakers[6]=function(e){var r;if(1===e.substFormat)return new table.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:e.substFormat},{name:"coverage",type:"TABLE",value:new table.Coverage(e.coverage)}].concat(table.tableList("chainRuleSet",e.chainRuleSets,function(e){return new table.Table("chainRuleSetTable",table.tableList("chainRule",e,function(e){var r=table.ushortList("backtrackGlyph",e.backtrack,e.backtrack.length).concat(table.ushortList("inputGlyph",e.input,e.input.length+1)).concat(table.ushortList("lookaheadGlyph",e.lookahead,e.lookahead.length)).concat(table.ushortList("substitution",[],e.lookupRecords.length));return e.lookupRecords.forEach(function(e,t){r=r.concat({name:"sequenceIndex"+t,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+t,type:"USHORT",value:e.lookupListIndex})}),new table.Table("chainRuleTable",r)}))})));if(2===e.substFormat)check.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(3===e.substFormat)return(r=[{name:"substFormat",type:"USHORT",value:e.substFormat}]).push({name:"backtrackGlyphCount",type:"USHORT",value:e.backtrackCoverage.length}),e.backtrackCoverage.forEach(function(e,t){r.push({name:"backtrackCoverage"+t,type:"TABLE",value:new table.Coverage(e)})}),r.push({name:"inputGlyphCount",type:"USHORT",value:e.inputCoverage.length}),e.inputCoverage.forEach(function(e,t){r.push({name:"inputCoverage"+t,type:"TABLE",value:new table.Coverage(e)})}),r.push({name:"lookaheadGlyphCount",type:"USHORT",value:e.lookaheadCoverage.length}),e.lookaheadCoverage.forEach(function(e,t){r.push({name:"lookaheadCoverage"+t,type:"TABLE",value:new table.Coverage(e)})}),r.push({name:"substitutionCount",type:"USHORT",value:e.lookupRecords.length}),e.lookupRecords.forEach(function(e,t){r=r.concat({name:"sequenceIndex"+t,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+t,type:"USHORT",value:e.lookupListIndex})}),new table.Table("chainContextTable",r);check.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};var gsub={parse:parseGsubTable,make:makeGsubTable};function parseMetaTable(e,t){for(var r=new parse.Parser(e,t),a=r.parseULong(),n=(check.argument(1===a,"Unsupported META table version."),r.parseULong(),r.parseULong(),r.parseULong()),o={},s=0;s<n;s++){var i=r.parseTag(),u=r.parseULong(),l=r.parseULong(),u=decode.UTF8(e,t+u,l);o[i]=u}return o}function makeMetaTable(e){var t,r=Object.keys(e).length,a="",n=16+12*r,o=new table.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:n},{name:"numTags",type:"ULONG",value:r}]);for(t in e){var s=a.length;a+=e[t],o.fields.push({name:"tag "+t,type:"TAG",value:t}),o.fields.push({name:"offset "+t,type:"ULONG",value:n+s}),o.fields.push({name:"length "+t,type:"ULONG",value:e[t].length})}return o.fields.push({name:"stringPool",type:"CHARARRAY",value:a}),o}var meta={parse:parseMetaTable,make:makeMetaTable};function log2(e){return Math.log(e)/Math.log(2)|0}function computeCheckSum(e){for(;e.length%4!=0;)e.push(0);for(var t=0,r=0;r<e.length;r+=4)t+=(e[r]<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];return t%=Math.pow(2,32)}function makeTableRecord(e,t,r,a){return new table.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==r?r:0},{name:"length",type:"ULONG",value:void 0!==a?a:0}])}function makeSfntTable(e){for(var t=new table.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),r=(t.tables=e,t.numTables=e.length,Math.pow(2,log2(t.numTables))),a=(t.searchRange=16*r,t.entrySelector=log2(r),t.rangeShift=16*t.numTables-t.searchRange,[]),n=[],o=t.sizeOf()+makeTableRecord().sizeOf()*t.numTables;o%4!=0;)o+=1,n.push({name:"padding",type:"BYTE",value:0});for(var s=0;s<e.length;s+=1){var i=e[s],u=(check.argument(4===i.tableName.length,"Table name"+i.tableName+" is invalid."),i.sizeOf()),l=makeTableRecord(i.tableName,computeCheckSum(i.encode()),o,u);for(a.push({name:l.tag+" Table Record",type:"RECORD",value:l}),n.push({name:i.tableName+" table",type:"RECORD",value:i}),o+=u,check.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,n.push({name:"padding",type:"BYTE",value:0})}return a.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(a),t.fields=t.fields.concat(n),t}function metricsForChar(e,t,r){for(var a=0;a<t.length;a+=1){var n=e.charToGlyphIndex(t[a]);if(0<n)return e.glyphs.get(n).getMetrics()}return r}function average(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r];return t/e.length}function fontToSfntTable(e){for(var t,r=[],a=[],n=[],o=[],s=[],i=[],u=[],l=0,p=0,c=0,h=0,f=0,d=0;d<e.glyphs.length;d+=1){var g=e.glyphs.get(d),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+d+"): advanceWidth is not a number.");(m<t||void 0===t)&&0<m&&(t=m),l<m&&(l=m);var m=os2.getUnicodeRange(m);if(m<32)p|=1<<m;else if(m<64)c|=1<<m-32;else if(m<96)h|=1<<m-64;else{if(!(m<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");f|=1<<m-96}".notdef"!==g.name&&(m=g.getMetrics(),r.push(m.xMin),a.push(m.yMin),n.push(m.xMax),o.push(m.yMax),i.push(m.leftSideBearing),u.push(m.rightSideBearing),s.push(g.advanceWidth))}var v,y={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,a),xMax:Math.max.apply(null,n),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,s),advanceWidthAvg:average(s),minLeftSideBearing:Math.min.apply(null,i),maxLeftSideBearing:Math.max.apply(null,i),minRightSideBearing:Math.min.apply(null,u)},b=(y.ascender=e.ascender,y.descender=e.descender,head.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:y.xMin,yMin:y.yMin,xMax:y.xMax,yMax:y.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp})),S=hhea.make({ascender:y.ascender,descender:y.descender,advanceWidthMax:y.advanceWidthMax,minLeftSideBearing:y.minLeftSideBearing,minRightSideBearing:y.minRightSideBearing,xMaxExtent:y.maxLeftSideBearing+(y.xMax-y.xMin),numberOfHMetrics:e.glyphs.length}),T=maxp.make(e.glyphs.length),x=os2.make(Object.assign({xAvgCharWidth:Math.round(y.advanceWidthAvg),usFirstCharIndex:t,usLastCharIndex:l,ulUnicodeRange1:p,ulUnicodeRange2:c,ulUnicodeRange3:h,ulUnicodeRange4:f,sTypoAscender:y.ascender,sTypoDescender:y.descender,sTypoLineGap:0,usWinAscent:y.yMax,usWinDescent:Math.abs(y.yMin),ulCodePageRange1:1,sxHeight:metricsForChar(e,"xyvw",{yMax:Math.round(y.ascender/2)}).yMax,sCapHeight:metricsForChar(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",y).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0},e.tables.os2)),k=hmtx.make(e.glyphs),P=cmap.make(e.glyphs),C=e.getEnglishName("fontFamily"),U=e.getEnglishName("fontSubfamily"),R=C+" "+U,O=(O=e.getEnglishName("postScriptName"))||C.replace(/\s/g,"")+"-"+U,E={};for(v in e.names)E[v]=e.names[v];E.uniqueID||(E.uniqueID={en:e.getEnglishName("manufacturer")+":"+R}),E.postScriptName||(E.postScriptName={en:O}),E.preferredFamily||(E.preferredFamily=e.names.fontFamily),E.preferredSubfamily||(E.preferredSubfamily=e.names.fontSubfamily);for(var L=[],D=_name.make(E,L),L=0<L.length?ltag.make(L):void 0,F=post.make(),R=cff.make(e.glyphs,{version:e.getEnglishName("version"),fullName:R,familyName:C,weightName:U,postScriptName:O,unitsPerEm:e.unitsPerEm,fontBBox:[0,y.yMin,y.ascender,y.advanceWidthMax]}),C=e.metas&&0<Object.keys(e.metas).length?meta.make(e.metas):void 0,U=[b,S,T,x,D,P,F,R,k],O=(L&&U.push(L),e.tables.gsub&&U.push(gsub.make(e.tables.gsub)),C&&U.push(C),makeSfntTable(U)),A=computeCheckSum(O.encode()),I=O.fields,M=!1,w=0;w<I.length;w+=1)if("head table"===I[w].name){I[w].value.checkSumAdjustment=2981146554-A,M=!0;break}if(M)return O;throw new Error("Could not find head table with checkSum to adjust.")}var sfnt={make:makeSfntTable,fontToTable:fontToSfntTable,computeCheckSum:computeCheckSum};function searchTag(e,t){for(var r=0,a=e.length-1;r<=a;){var n=r+a>>>1,o=e[n].tag;if(o===t)return n;o<t?r=1+n:a=n-1}return-r-1}function binSearch(e,t){for(var r=0,a=e.length-1;r<=a;){var n=r+a>>>1,o=e[n];if(o===t)return n;o<t?r=1+n:a=n-1}return-r-1}function searchRange(e,t){for(var r=0,a=e.length-1;r<=a;){var n,o=r+a>>>1,s=(n=e[o]).start;if(s===t)return n;s<t?r=1+o:a=o-1}if(0<r)return t>(n=e[r-1]).end?0:n}function Layout(e,t){this.font=e,this.tableName=t}function Position(e){Layout.call(this,e,"gpos")}function Substitution(e){Layout.call(this,e,"gsub")}function arraysEqual(e,t){var r=e.length;if(r!==t.length)return!1;for(var a=0;a<r;a++)if(e[a]!==t[a])return!1;return!0}function getSubstFormat(e,t,r){for(var a=e.subtables,n=0;n<a.length;n++){var o=a[n];if(o.substFormat===t)return o}if(r)return a.push(r),r}function isBrowser(){return"undefined"!=typeof window}function nodeBufferToArrayBuffer(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a<e.length;++a)r[a]=e[a];return t}function arrayBufferToNodeBuffer(e){for(var t=new Buffer(e.byteLength),r=new Uint8Array(e),a=0;a<t.length;++a)t[a]=r[a];return t}function checkArgument(e,t){if(!e)throw t}function parseGlyphCoordinate(e,t,r,a,n){var o=0<(t&a)?(o=e.parseByte(),r+(o=0==(t&n)?-o:o)):0<(t&n)?r:r+e.parseShort();return o}function parseGlyph(e,t,r){var a,n=new parse.Parser(t,r);if(e.numberOfContours=n.parseShort(),e._xMin=n.parseShort(),e._yMin=n.parseShort(),e._xMax=n.parseShort(),e._yMax=n.parseShort(),0<e.numberOfContours){for(var o=e.endPointIndices=[],s=0;s<e.numberOfContours;s+=1)o.push(n.parseUShort());e.instructionLength=n.parseUShort(),e.instructions=[];for(var i=0;i<e.instructionLength;i+=1)e.instructions.push(n.parseByte());for(var u=o[o.length-1]+1,l=[],p=0;p<u;p+=1)if(a=n.parseByte(),l.push(a),0<(8&a))for(var c=n.parseByte(),h=0;h<c;h+=1)l.push(a),p+=1;if(check.argument(l.length===u,"Bad flags."),0<o.length){var f,d=[];if(0<u){for(var g=0;g<u;g+=1)a=l[g],(f={}).onCurve=!!(1&a),f.lastPointOfContour=0<=o.indexOf(g),d.push(f);for(var m=0,v=0;v<u;v+=1)a=l[v],(f=d[v]).x=parseGlyphCoordinate(n,a,m,2,16),m=f.x;for(var y=0,b=0;b<u;b+=1)a=l[b],(f=d[b]).y=parseGlyphCoordinate(n,a,y,4,32),y=f.y}e.points=d}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var S=!0;S;){l=n.parseUShort();var T={glyphIndex:n.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&l)?0<(2&l)?(T.dx=n.parseShort(),T.dy=n.parseShort()):T.matchedPoints=[n.parseUShort(),n.parseUShort()]:0<(2&l)?(T.dx=n.parseChar(),T.dy=n.parseChar()):T.matchedPoints=[n.parseByte(),n.parseByte()],0<(8&l)?T.xScale=T.yScale=n.parseF2Dot14():0<(64&l)?(T.xScale=n.parseF2Dot14(),T.yScale=n.parseF2Dot14()):0<(128&l)&&(T.xScale=n.parseF2Dot14(),T.scale01=n.parseF2Dot14(),T.scale10=n.parseF2Dot14(),T.yScale=n.parseF2Dot14()),e.components.push(T),S=!!(32&l)}if(256&l){e.instructionLength=n.parseUShort(),e.instructions=[];for(var x=0;x<e.instructionLength;x+=1)e.instructions.push(n.parseByte())}}}function transformPoints(e,t){for(var r=[],a=0;a<e.length;a+=1){var n=e[a],n={x:t.xScale*n.x+t.scale01*n.y+t.dx,y:t.scale10*n.x+t.yScale*n.y+t.dy,onCurve:n.onCurve,lastPointOfContour:n.lastPointOfContour};r.push(n)}return r}function getContours(e){for(var t=[],r=[],a=0;a<e.length;a+=1){var n=e[a];r.push(n),n.lastPointOfContour&&(t.push(r),r=[])}return check.argument(0===r.length,"There are still points left in the current contour."),t}function getPath(e){var t=new Path;if(e)for(var r=getContours(e),a=0;a<r.length;++a){var n,o=r[a],s=o[o.length-1],i=o[0];s.onCurve?t.moveTo(s.x,s.y):i.onCurve?t.moveTo(i.x,i.y):(n={x:.5*(s.x+i.x),y:.5*(s.y+i.y)},t.moveTo(n.x,n.y));for(var u=0;u<o.length;++u){var l,p=s,s=i,i=o[(u+1)%o.length];s.onCurve?t.lineTo(s.x,s.y):(l=i,p.onCurve||(s.x,p.x,s.y,p.y),i.onCurve||(l={x:.5*(s.x+i.x),y:.5*(s.y+i.y)}),t.quadraticCurveTo(s.x,s.y,l.x,l.y))}t.closePath()}return t}function buildPath(e,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var a=t.components[r],n=e.get(a.glyphIndex);if(n.getPath(),n.points){var o=void 0;if(void 0===a.matchedPoints)o=transformPoints(n.points,a);else{if(a.matchedPoints[0]>t.points.length-1||a.matchedPoints[1]>n.points.length-1)throw Error("Matched points out of range in "+t.name);var s=t.points[a.matchedPoints[0]],i=n.points[a.matchedPoints[1]],a={xScale:a.xScale,scale01:a.scale01,scale10:a.scale10,yScale:a.yScale,dx:0,dy:0},i=transformPoints([i],a)[0];a.dx=s.x-i.x,a.dy=s.y-i.y,o=transformPoints(n.points,a)}t.points=t.points.concat(o)}}return getPath(t.points)}function parseGlyfTableAll(e,t,r,a){for(var n=new glyphset.GlyphSet(a),o=0;o<r.length-1;o+=1){var s=r[o];s!==r[o+1]?n.push(o,glyphset.ttfGlyphLoader(a,o,parseGlyph,e,t+s,buildPath)):n.push(o,glyphset.glyphLoader(a,o))}return n}function parseGlyfTableOnLowMemory(r,a,n,o){var s=new glyphset.GlyphSet(o);return o._push=function(e){var t=n[e];t!==n[e+1]?s.push(e,glyphset.ttfGlyphLoader(o,e,parseGlyph,r,a+t,buildPath)):s.push(e,glyphset.glyphLoader(o,e))},s}function parseGlyfTable(e,t,r,a,n){return(n.lowMemory?parseGlyfTableOnLowMemory:parseGlyfTableAll)(e,t,r,a)}Layout.prototype={searchTag:searchTag,binSearch:binSearch,getTable:function(e){var t=this.font.tables[this.tableName];return t=!t&&e?this.font.tables[this.tableName]=this.createDefaultTable():t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map(function(e){return e.tag}):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,r=0;r<e.scripts.length;r++){var a=e.scripts[r].tag;if("DFLT"===a)return a;"latn"===a&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var r,a=this.getTable(t);if(a)return r=a.scripts,0<=(a=searchTag(a.scripts,e=e||"DFLT"))?r[a].script:t?(r.splice(-1-a,0,t={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}),t.script):void 0},getLangSysTable:function(e,t,r){var a,e=this.getScriptTable(e,r);if(e)return t&&"dflt"!==t&&"DFLT"!==t?0<=(a=searchTag(e.langSysRecords,t))?e.langSysRecords[a].langSys:r?(e.langSysRecords.splice(-1-a,0,r={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}}),r.langSys):void 0:e.defaultLangSys},getFeatureTable:function(e,t,r,a){e=this.getLangSysTable(e,t,a);if(e){for(var n,o=e.featureIndexes,s=this.font.tables[this.tableName].features,i=0;i<o.length;i++)if((n=s[o[i]]).tag===r)return n.feature;if(a)return t=s.length,check.assert(0===t||r>=s[t-1].tag,"Features must be added in alphabetical order."),s.push(n={tag:r,feature:{params:0,lookupListIndexes:[]}}),o.push(t),n.feature}},getLookupTables:function(e,t,r,a,n){var e=this.getFeatureTable(e,t,r,n),o=[];if(e){for(var s,i=e.lookupListIndexes,u=this.font.tables[this.tableName].lookups,l=0;l<i.length;l++)(s=u[i[l]]).lookupType===a&&o.push(s);if(0===o.length&&n)return t=u.length,u.push(s={lookupType:a,lookupFlag:0,subtables:[],markFilteringSet:void 0}),i.push(t),[s]}return o},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var r=searchRange(e.ranges,t);return r?r.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var r=binSearch(e.glyphs,t);return 0<=r?r:-1;case 2:r=searchRange(e.ranges,t);return r?r.index+t-r.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],r=e.ranges,a=0;a<r.length;a++)for(var n=r[a],o=n.start,s=n.end,i=o;i<=s;i++)t.push(i);return t}},Position.prototype=Layout.prototype,Position.prototype.init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},Position.prototype.getKerningValue=function(e,t,r){for(var a=0;a<e.length;a++)for(var n=e[a].subtables,o=0;o<n.length;o++){var s=n[o],i=this.getCoverageIndex(s.coverage,t);if(!(i<0))switch(s.posFormat){case 1:for(var u=s.pairSets[i],l=0;l<u.length;l++){var p=u[l];if(p.secondGlyph===r)return p.value1&&p.value1.xAdvance||0}break;case 2:var c=this.getGlyphClass(s.classDef1,t),h=this.getGlyphClass(s.classDef2,r),c=s.classRecords[c][h];return c.value1&&c.value1.xAdvance||0}}return 0},Position.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},Substitution.prototype=Layout.prototype,Substitution.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Substitution.prototype.getSingle=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,1),o=0;o<n.length;o++)for(var s=n[o].subtables,i=0;i<s.length;i++){var u=s[i],l=this.expandCoverage(u.coverage),p=void 0;if(1===u.substFormat)for(var c=u.deltaGlyphId,p=0;p<l.length;p++){var h=l[p];a.push({sub:h,by:h+c})}else{var f=u.substitute;for(p=0;p<l.length;p++)a.push({sub:l[p],by:f[p]})}}return a},Substitution.prototype.getMultiple=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,2),o=0;o<n.length;o++)for(var s=n[o].subtables,i=0;i<s.length;i++)for(var u=s[i],l=this.expandCoverage(u.coverage),p=void 0,p=0;p<l.length;p++){var c=l[p],h=u.sequences[p];a.push({sub:c,by:h})}return a},Substitution.prototype.getAlternates=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,3),o=0;o<n.length;o++)for(var s=n[o].subtables,i=0;i<s.length;i++)for(var u=s[i],l=this.expandCoverage(u.coverage),p=u.alternateSets,c=0;c<l.length;c++)a.push({sub:l[c],by:p[c]});return a},Substitution.prototype.getLigatures=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,4),o=0;o<n.length;o++)for(var s=n[o].subtables,i=0;i<s.length;i++)for(var u=s[i],l=this.expandCoverage(u.coverage),p=u.ligatureSets,c=0;c<l.length;c++)for(var h=l[c],f=p[c],d=0;d<f.length;d++){var g=f[d];a.push({sub:[h].concat(g.components),by:g.ligGlyph})}return a},Substitution.prototype.addSingle=function(e,t,r,a){r=getSubstFormat(this.getLookupTables(r,a,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]}),check.assert(1===r.coverage.format,"Single: unable to modify coverage table format "+r.coverage.format),a=t.sub,e=this.binSearch(r.coverage.glyphs,a);e<0&&(r.coverage.glyphs.splice(e=-1-e,0,a),r.substitute.splice(e,0,0)),r.substitute[e]=t.by},Substitution.prototype.addMultiple=function(e,t,r,a){check.assert(t.by instanceof Array&&1<t.by.length,'Multiple: "by" must be an array of two or more ids');r=getSubstFormat(this.getLookupTables(r,a,e,2,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]}),check.assert(1===r.coverage.format,"Multiple: unable to modify coverage table format "+r.coverage.format),a=t.sub,e=this.binSearch(r.coverage.glyphs,a);e<0&&(r.coverage.glyphs.splice(e=-1-e,0,a),r.sequences.splice(e,0,0)),r.sequences[e]=t.by},Substitution.prototype.addAlternate=function(e,t,r,a){r=getSubstFormat(this.getLookupTables(r,a,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]}),check.assert(1===r.coverage.format,"Alternate: unable to modify coverage table format "+r.coverage.format),a=t.sub,e=this.binSearch(r.coverage.glyphs,a);e<0&&(r.coverage.glyphs.splice(e=-1-e,0,a),r.alternateSets.splice(e,0,0)),r.alternateSets[e]=t.by},Substitution.prototype.addLigature=function(e,t,r,a){var r=this.getLookupTables(r,a,e,4,!0)[0],a=r.subtables[0],e=(a||(r.subtables[0]=a={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),check.assert(1===a.coverage.format,"Ligature: unable to modify coverage table format "+a.coverage.format),t.sub[0]),n=t.sub.slice(1),r={ligGlyph:t.by,components:n},t=this.binSearch(a.coverage.glyphs,e);if(0<=t){for(var o=a.ligatureSets[t],s=0;s<o.length;s++)if(arraysEqual(o[s].components,n))return;o.push(r)}else a.coverage.glyphs.splice(t=-1-t,0,e),a.ligatureSets.splice(t,0,[r])},Substitution.prototype.getFeature=function(e,t,r){if(/ss\d\d/.test(e))return this.getSingle(e,t,r);switch(e){case"aalt":case"salt":return this.getSingle(e,t,r).concat(this.getAlternates(e,t,r));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,r);case"ccmp":return this.getMultiple(e,t,r).concat(this.getLigatures(e,t,r));case"stch":return this.getMultiple(e,t,r)}},Substitution.prototype.add=function(e,t,r,a){if(/ss\d\d/.test(e))return this.addSingle(e,t,r,a);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,r,a):this.addAlternate(e,t,r,a);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,r,a);case"ccmp":return t.by instanceof Array?this.addMultiple(e,t,r,a):this.addLigature(e,t,r,a)}};var instructionTable,exec,execGlyph,execComponent,glyf={getPath:getPath,parse:parseGlyfTable};function Hinting(e){this.font=e,this.getCommands=function(e){return glyf.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function roundOff(e){return e}function roundToGrid(e){return Math.sign(e)*Math.round(Math.abs(e))}function roundToDoubleGrid(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function roundToHalfGrid(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function roundUpToGrid(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function roundDownToGrid(e){return Math.sign(e)*Math.floor(Math.abs(e))}var roundSuper=function(e){var t=this.srPeriod,r=this.srPhase,a=1;return e<0&&(e=-e,a=-1),e+=this.srThreshold-r,e=Math.trunc(e/t)*t,(e+=r)<0?r*a:e*a},xUnitVector={x:1,y:0,axis:"x",distance:function(e,t,r,a){return(r?e.xo:e.x)-(a?t.xo:t.x)},interpolate:function(e,t,r,a){var n,o,s,i,u,l,p;if(!a||a===this)return n=e.xo-t.xo,o=e.xo-r.xo,u=t.x-t.xo,l=r.x-r.xo,0===(p=(s=Math.abs(n))+(i=Math.abs(o)))?void(e.x=e.xo+(u+l)/2):void(e.x=e.xo+(u*i+l*s)/p);n=a.distance(e,t,!0,!0),o=a.distance(e,r,!0,!0),u=a.distance(t,t,!1,!0),l=a.distance(r,r,!1,!0),0===(p=(s=Math.abs(n))+(i=Math.abs(o)))?xUnitVector.setRelative(e,e,(u+l)/2,a,!0):xUnitVector.setRelative(e,e,(u*i+l*s)/p,a,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,r,a,n){var o,s;a&&a!==this?(o=n?t.xo:t.x,s=n?t.yo:t.y,o+=r*a.x,s+=r*a.y,e.x=o+(e.y-s)/a.normalSlope):e.x=(n?t.xo:t.x)+r},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},yUnitVector={x:0,y:1,axis:"y",distance:function(e,t,r,a){return(r?e.yo:e.y)-(a?t.yo:t.y)},interpolate:function(e,t,r,a){var n,o,s,i,u,l,p;if(!a||a===this)return n=e.yo-t.yo,o=e.yo-r.yo,u=t.y-t.yo,l=r.y-r.yo,0===(p=(s=Math.abs(n))+(i=Math.abs(o)))?void(e.y=e.yo+(u+l)/2):void(e.y=e.yo+(u*i+l*s)/p);n=a.distance(e,t,!0,!0),o=a.distance(e,r,!0,!0),u=a.distance(t,t,!1,!0),l=a.distance(r,r,!1,!0),0===(p=(s=Math.abs(n))+(i=Math.abs(o)))?yUnitVector.setRelative(e,e,(u+l)/2,a,!0):yUnitVector.setRelative(e,e,(u*i+l*s)/p,a,!0)},normalSlope:0,setRelative:function(e,t,r,a,n){var o,s;a&&a!==this?(o=n?t.xo:t.x,s=n?t.yo:t.y,o+=r*a.x,s+=r*a.y,e.y=s+a.normalSlope*(e.x-o)):e.y=(n?t.yo:t.y)+r},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function UnitVector(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function getUnitVector(e,t){var r=Math.sqrt(e*e+t*t);return t/=r,1===(e/=r)&&0===t?xUnitVector:0===e&&1===t?yUnitVector:new UnitVector(e,t)}function HPoint(e,t,r,a){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=r,this.onCurve=a,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(xUnitVector),Object.freeze(yUnitVector),UnitVector.prototype.distance=function(e,t,r,a){return this.x*xUnitVector.distance(e,t,r,a)+this.y*yUnitVector.distance(e,t,r,a)},UnitVector.prototype.interpolate=function(e,t,r,a){var n=a.distance(e,t,!0,!0),o=a.distance(e,r,!0,!0),t=a.distance(t,t,!1,!0),r=a.distance(r,r,!1,!0),n=Math.abs(n),o=Math.abs(o),s=n+o;0===s?this.setRelative(e,e,(t+r)/2,a,!0):this.setRelative(e,e,(t*o+r*n)/s,a,!0)},UnitVector.prototype.setRelative=function(e,t,r,a,n){var o=n?t.xo:t.x,n=n?t.yo:t.y,t=o+r*(a=a||this).x,o=n+r*a.y,n=a.normalSlope,r=this.slope,a=e.x,s=e.y;e.x=(r*a-n*t+o-s)/(r-n),e.y=r*(e.x-a)+s},UnitVector.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},HPoint.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},HPoint.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var HPZero=Object.freeze(new HPoint(0,0)),defaultState={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function State(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=xUnitVector,this.round=roundToGrid}}function initTZone(e){for(var t=e.tZone=new Array(e.gZone.length),r=0;r<t.length;r++)t[r]=new HPoint(0,0)}function skip(e,t){var r,a=e.prog,n=e.ip,o=1;do{if(88===(r=a[++n]))o++;else if(89===r)o--;else if(64===r)n+=a[n+1]+1;else if(65===r)n+=2*a[n+1]+1;else if(176<=r&&r<=183)n+=r-176+1;else if(184<=r&&r<=191)n+=2*(r-184+1);else if(t&&1===o&&27===r)break}while(0<o);e.ip=n}function SVTCA(e,t){exports.DEBUG&&console.log(t.step,"SVTCA["+e.axis+"]"),t.fv=t.pv=t.dpv=e}function SPVTCA(e,t){exports.DEBUG&&console.log(t.step,"SPVTCA["+e.axis+"]"),t.pv=t.dpv=e}function SFVTCA(e,t){exports.DEBUG&&console.log(t.step,"SFVTCA["+e.axis+"]"),t.fv=e}function SPVTL(e,t){var r,a=t.stack,n=a.pop(),a=a.pop(),o=t.z2[n],s=t.z1[a];exports.DEBUG&&console.log("SPVTL["+e+"]",n,a),n=e?(r=o.y-s.y,s.x-o.x):(r=s.x-o.x,s.y-o.y),t.pv=t.dpv=getUnitVector(r,n)}function SFVTL(e,t){var r,a=t.stack,n=a.pop(),a=a.pop(),o=t.z2[n],s=t.z1[a];exports.DEBUG&&console.log("SFVTL["+e+"]",n,a),n=e?(r=o.y-s.y,s.x-o.x):(r=s.x-o.x,s.y-o.y),t.fv=getUnitVector(r,n)}function SPVFS(e){var t=e.stack,r=t.pop(),t=t.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",r,t),e.pv=e.dpv=getUnitVector(t,r)}function SFVFS(e){var t=e.stack,r=t.pop(),t=t.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",r,t),e.fv=getUnitVector(t,r)}function GPV(e){var t=e.stack,r=e.pv;exports.DEBUG&&console.log(e.step,"GPV[]"),t.push(16384*r.x),t.push(16384*r.y)}function GFV(e){var t=e.stack,r=e.fv;exports.DEBUG&&console.log(e.step,"GFV[]"),t.push(16384*r.x),t.push(16384*r.y)}function SFVTPV(e){e.fv=e.pv,exports.DEBUG&&console.log(e.step,"SFVTPV[]")}function ISECT(e){var t=e.stack,r=t.pop(),a=t.pop(),n=t.pop(),o=t.pop(),t=t.pop(),s=e.z0,i=e.z1,u=s[r],s=s[a],l=i[n],i=i[o],e=e.z2[t],r=(exports.DEBUG&&console.log("ISECT[], ",r,a,n,o,t),u.x),a=u.y,n=s.x,o=s.y,t=l.x,u=l.y,s=i.x,l=i.y,i=(r-n)*(u-l)-(a-o)*(t-s),p=r*o-a*n,c=t*l-u*s;e.x=(p*(t-s)-c*(r-n))/i,e.y=(p*(u-l)-c*(a-o))/i}function SRP0(e){e.rp0=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)}function SRP1(e){e.rp1=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)}function SRP2(e){e.rp2=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)}function SZP0(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP0[]",t),e.zp0=t){case 0:e.tZone||initTZone(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP1(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP1[]",t),e.zp1=t){case 0:e.tZone||initTZone(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP2(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP2[]",t),e.zp2=t){case 0:e.tZone||initTZone(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZPS(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZPS[]",t),e.zp0=e.zp1=e.zp2=t){case 0:e.tZone||initTZone(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function SLOOP(e){e.loop=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)}function RTG(e){exports.DEBUG&&console.log(e.step,"RTG[]"),e.round=roundToGrid}function RTHG(e){exports.DEBUG&&console.log(e.step,"RTHG[]"),e.round=roundToHalfGrid}function SMD(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SMD[]",t),e.minDis=t/64}function ELSE(e){exports.DEBUG&&console.log(e.step,"ELSE[]"),skip(e,!1)}function JMPR(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"JMPR[]",t),e.ip+=t-1}function SCVTCI(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCVTCI[]",t),e.cvCutIn=t/64}function DUP(e){var t=e.stack;exports.DEBUG&&console.log(e.step,"DUP[]"),t.push(t[t.length-1])}function POP(e){exports.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function CLEAR(e){exports.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0}function SWAP(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"SWAP[]"),t.push(r),t.push(a)}function DEPTH(e){var t=e.stack;exports.DEBUG&&console.log(e.step,"DEPTH[]"),t.push(t.length)}function LOOPCALL(e){var t=e.stack,r=t.pop(),a=t.pop(),t=(exports.DEBUG&&console.log(e.step,"LOOPCALL[]",r,a),e.ip),n=e.prog;e.prog=e.funcs[r];for(var o=0;o<a;o++)exec(e),exports.DEBUG&&console.log(++e.step,o+1<a?"next loopcall":"done loopcall",o);e.ip=t,e.prog=n}function CALL(e){var t=e.stack.pop(),r=(exports.DEBUG&&console.log(e.step,"CALL[]",t),e.ip),a=e.prog;e.prog=e.funcs[t],exec(e),e.ip=r,e.prog=a,exports.DEBUG&&console.log(++e.step,"returning from",t)}function CINDEX(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"CINDEX[]",r),t.push(t[t.length-r])}function MINDEX(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"MINDEX[]",r),t.push(t.splice(t.length-r,1)[0])}function FDEF(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var t=e.stack,r=e.prog,a=e.ip,t=t.pop(),n=a;for(exports.DEBUG&&console.log(e.step,"FDEF[]",t);45!==r[++a];);e.ip=a,e.funcs[t]=r.slice(n+1,a)}function MDAP(e,t){var r=t.stack.pop(),a=t.z0[r],n=t.fv,o=t.pv,s=(exports.DEBUG&&console.log(t.step,"MDAP["+e+"]",r),o.distance(a,HPZero));e&&(s=t.round(s)),n.setRelative(a,HPZero,s,o),n.touch(a),t.rp0=t.rp1=r}function IUP(e,t){var r,a,n,o=t.z2,s=o.length-2;exports.DEBUG&&console.log(t.step,"IUP["+e.axis+"]");for(var i=0;i<s;i++)r=o[i],e.touched(r)||(a=r.prevTouched(e))!==r&&(a===(n=r.nextTouched(e))&&e.setRelative(r,r,e.distance(a,a,!1,!0),e,!0),e.interpolate(r,a,n,e))}function SHP(e,t){for(var r=t.stack,a=e?t.rp1:t.rp2,n=(e?t.z0:t.z1)[a],o=t.fv,s=t.pv,i=t.loop,u=t.z2;i--;){var l=r.pop(),p=u[l],c=s.distance(n,n,!1,!0);o.setRelative(p,p,c,s),o.touch(p),exports.DEBUG&&console.log(t.step,(1<t.loop?"loop "+(t.loop-i)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",l)}t.loop=1}function SHC(e,t){for(var r=t.stack,a=e?t.rp1:t.rp2,n=(e?t.z0:t.z1)[a],o=t.fv,s=t.pv,a=r.pop(),i=t.z2[t.contours[a]],u=i,l=(exports.DEBUG&&console.log(t.step,"SHC["+e+"]",a),s.distance(n,n,!1,!0));u!==n&&o.setRelative(u,u,l,s),(u=u.nextPointOnContour)!==i;);}function SHZ(e,t){var r,a,n=t.stack,o=e?t.rp1:t.rp2,o=(e?t.z0:t.z1)[o],s=t.fv,i=t.pv,n=n.pop();switch(exports.DEBUG&&console.log(t.step,"SHZ["+e+"]",n),n){case 0:r=t.tZone;break;case 1:r=t.gZone;break;default:throw new Error("Invalid zone")}for(var u=i.distance(o,o,!1,!0),l=r.length-2,p=0;p<l;p++)a=r[p],s.setRelative(a,a,u,i)}function SHPIX(e){for(var t=e.stack,r=e.loop,a=e.fv,n=t.pop()/64,o=e.z2;r--;){var s=t.pop(),i=o[s];exports.DEBUG&&console.log(e.step,(1<e.loop?"loop "+(e.loop-r)+": ":"")+"SHPIX[]",s,n),a.setRelative(i,i,n),a.touch(i)}e.loop=1}function IP(e){for(var t=e.stack,r=e.rp1,a=e.rp2,n=e.loop,o=e.z0[r],s=e.z1[a],i=e.fv,u=e.dpv,l=e.z2;n--;){var p=t.pop(),c=l[p];exports.DEBUG&&console.log(e.step,(1<e.loop?"loop "+(e.loop-n)+": ":"")+"IP[]",p,r,"<->",a),i.interpolate(c,o,s,u),i.touch(c)}e.loop=1}function MSIRP(e,t){var r=t.stack,a=r.pop()/64,r=r.pop(),n=t.z1[r],o=t.z0[t.rp0],s=t.fv,i=t.pv;s.setRelative(n,o,a,i),s.touch(n),exports.DEBUG&&console.log(t.step,"MSIRP["+e+"]",a,r),t.rp1=t.rp0,t.rp2=r,e&&(t.rp0=r)}function ALIGNRP(e){for(var t=e.stack,r=e.rp0,a=e.z0[r],n=e.loop,o=e.fv,s=e.pv,i=e.z1;n--;){var u=t.pop(),l=i[u];exports.DEBUG&&console.log(e.step,(1<e.loop?"loop "+(e.loop-n)+": ":"")+"ALIGNRP[]",u),o.setRelative(l,a,0,s),o.touch(l)}e.loop=1}function RTDG(e){exports.DEBUG&&console.log(e.step,"RTDG[]"),e.round=roundToDoubleGrid}function MIAP(e,t){var r=t.stack,a=r.pop(),r=r.pop(),n=t.z0[r],o=t.fv,s=t.pv,i=t.cvt[a],a=(exports.DEBUG&&console.log(t.step,"MIAP["+e+"]",a,"(",i,")",r),s.distance(n,HPZero));e&&(Math.abs(a-i)<t.cvCutIn&&(a=i),a=t.round(a)),o.setRelative(n,HPZero,a,s),0===t.zp0&&(n.xo=n.x,n.yo=n.y),o.touch(n),t.rp0=t.rp1=r}function NPUSHB(e){var t=e.prog,r=e.ip,a=e.stack,n=t[++r];exports.DEBUG&&console.log(e.step,"NPUSHB[]",n);for(var o=0;o<n;o++)a.push(t[++r]);e.ip=r}function NPUSHW(e){var t=e.ip,r=e.prog,a=e.stack,n=r[++t];exports.DEBUG&&console.log(e.step,"NPUSHW[]",n);for(var o=0;o<n;o++){var s=r[++t]<<8|r[++t];32768&s&&(s=-(1+(65535^s))),a.push(s)}e.ip=t}function WS(e){var t=e.stack,r=(r=e.store)||(e.store=[]),a=t.pop(),t=t.pop();exports.DEBUG&&console.log(e.step,"WS",a,t),r[t]=a}function RS(e){var t=e.stack,r=e.store,a=t.pop(),e=(exports.DEBUG&&console.log(e.step,"RS",a),r&&r[a]||0);t.push(e)}function WCVTP(e){var t=e.stack,r=t.pop(),t=t.pop();exports.DEBUG&&console.log(e.step,"WCVTP",r,t),e.cvt[t]=r/64}function RCVT(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"RCVT",r),t.push(64*e.cvt[r])}function GC(e,t){var r=t.stack,a=r.pop(),n=t.z2[a];exports.DEBUG&&console.log(t.step,"GC["+e+"]",a),r.push(64*t.dpv.distance(n,HPZero,e,!1))}function MD(e,t){var r=t.stack,a=r.pop(),r=r.pop(),n=t.z1[a],o=t.z0[r],o=t.dpv.distance(o,n,e,e);exports.DEBUG&&console.log(t.step,"MD["+e+"]",a,r,"->",o),t.stack.push(Math.round(64*o))}function MPPEM(e){exports.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)}function FLIPON(e){exports.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0}function LT(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"LT[]",r,a),t.push(a<r?1:0)}function LTEQ(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"LTEQ[]",r,a),t.push(a<=r?1:0)}function GT(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"GT[]",r,a),t.push(r<a?1:0)}function GTEQ(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"GTEQ[]",r,a),t.push(r<=a?1:0)}function EQ(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"EQ[]",r,a),t.push(r===a?1:0)}function NEQ(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"NEQ[]",r,a),t.push(r!==a?1:0)}function ODD(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"ODD[]",r),t.push(Math.trunc(r)%2?1:0)}function EVEN(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"EVEN[]",r),t.push(Math.trunc(r)%2?0:1)}function IF(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"IF[]",t),t||(skip(e,!0),exports.DEBUG&&console.log(e.step,"EIF[]"))}function EIF(e){exports.DEBUG&&console.log(e.step,"EIF[]")}function AND(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"AND[]",r,a),t.push(r&&a?1:0)}function OR(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"OR[]",r,a),t.push(r||a?1:0)}function NOT(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"NOT[]",r),t.push(r?0:1)}function DELTAP123(e,t){var r=t.stack,a=r.pop(),n=t.fv,o=t.pv,s=t.ppem,i=t.deltaBase+16*(e-1),u=t.deltaShift,l=t.z0;exports.DEBUG&&console.log(t.step,"DELTAP["+e+"]",a,r);for(var p=0;p<a;p++){var c=r.pop(),h=r.pop();i+((240&h)>>4)===s&&(0<=(h=(15&h)-8)&&h++,exports.DEBUG&&console.log(t.step,"DELTAPFIX",c,"by",h*u),c=l[c],n.setRelative(c,c,h*u,o))}}function SDB(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SDB[]",t),e.deltaBase=t}function SDS(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SDS[]",t),e.deltaShift=Math.pow(.5,t)}function ADD(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"ADD[]",r,a),t.push(a+r)}function SUB(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"SUB[]",r,a),t.push(a-r)}function DIV(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"DIV[]",r,a),t.push(64*a/r)}function MUL(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"MUL[]",r,a),t.push(a*r/64)}function ABS(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"ABS[]",r),t.push(Math.abs(r))}function NEG(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"NEG[]",r),t.push(-r)}function FLOOR(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"FLOOR[]",r),t.push(64*Math.floor(r/64))}function CEILING(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"CEILING[]",r),t.push(64*Math.ceil(r/64))}function ROUND(e,t){var r=t.stack,a=r.pop();exports.DEBUG&&console.log(t.step,"ROUND[]"),r.push(64*t.round(a/64))}function WCVTF(e){var t=e.stack,r=t.pop(),t=t.pop();exports.DEBUG&&console.log(e.step,"WCVTF[]",r,t),e.cvt[t]=r*e.ppem/e.font.unitsPerEm}function DELTAC123(e,t){var r=t.stack,a=r.pop(),n=t.ppem,o=t.deltaBase+16*(e-1),s=t.deltaShift;exports.DEBUG&&console.log(t.step,"DELTAC["+e+"]",a,r);for(var i=0;i<a;i++){var u=r.pop(),l=r.pop();o+((240&l)>>4)===n&&(0<=(l=(15&l)-8)&&l++,l=l*s,exports.DEBUG&&console.log(t.step,"DELTACFIX",u,"by",l),t.cvt[u]+=l)}}function SROUND(e){var t,r=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SROUND[]",r),e.round=roundSuper,192&r){case 0:t=.5;break;case 64:t=1;break;case 128:t=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=t,48&r){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid SROUND value")}e.srThreshold=0===(r&=15)?0:(r/8-.5)*t}function S45ROUND(e){var t,r=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"S45ROUND[]",r),e.round=roundSuper,192&r){case 0:t=Math.sqrt(2)/2;break;case 64:t=Math.sqrt(2);break;case 128:t=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=t,48&r){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid S45ROUND value")}e.srThreshold=0===(r&=15)?0:(r/8-.5)*t}function ROFF(e){exports.DEBUG&&console.log(e.step,"ROFF[]"),e.round=roundOff}function RUTG(e){exports.DEBUG&&console.log(e.step,"RUTG[]"),e.round=roundUpToGrid}function RDTG(e){exports.DEBUG&&console.log(e.step,"RDTG[]"),e.round=roundDownToGrid}function SCANCTRL(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANCTRL[]",t)}function SDPVTL(e,t){var r,a=t.stack,n=a.pop(),a=a.pop(),o=t.z2[n],s=t.z1[a];exports.DEBUG&&console.log(t.step,"SDPVTL["+e+"]",n,a),n=e?(r=o.y-s.y,s.x-o.x):(r=s.x-o.x,s.y-o.y),t.dpv=getUnitVector(r,n)}function GETINFO(e){var t=e.stack,r=t.pop(),a=0;exports.DEBUG&&console.log(e.step,"GETINFO[]",r),1&r&&(a=35),32&r&&(a|=4096),t.push(a)}function ROLL(e){var t=e.stack,r=t.pop(),a=t.pop(),n=t.pop();exports.DEBUG&&console.log(e.step,"ROLL[]"),t.push(a),t.push(r),t.push(n)}function MAX(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"MAX[]",r,a),t.push(Math.max(a,r))}function MIN(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"MIN[]",r,a),t.push(Math.min(a,r))}function SCANTYPE(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANTYPE[]",t)}function INSTCTRL(e){var t=e.stack.pop(),r=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"INSTCTRL[]",t,r),t){case 1:return void(e.inhibitGridFit=!!r);case 2:return void(e.ignoreCvt=!!r);default:throw new Error("invalid INSTCTRL[] selector")}}function PUSHB(e,t){var r=t.stack,a=t.prog,n=t.ip;exports.DEBUG&&console.log(t.step,"PUSHB["+e+"]");for(var o=0;o<e;o++)r.push(a[++n]);t.ip=n}function PUSHW(e,t){var r=t.ip,a=t.prog,n=t.stack;exports.DEBUG&&console.log(t.ip,"PUSHW["+e+"]");for(var o=0;o<e;o++){var s=a[++r]<<8|a[++r];32768&s&&(s=-(1+(65535^s))),n.push(s)}t.ip=r}function MDRP_MIRP(e,t,r,a,n,o){var s,i,u=o.stack,l=e&&u.pop(),u=u.pop(),p=o.rp0,p=o.z0[p],c=o.z1[u],h=o.minDis,f=o.fv,d=o.dpv,g=s=d.distance(c,p,!0,!0),m=0<=g?1:-1;g=Math.abs(g),e&&(i=o.cvt[l],a&&Math.abs(g-i)<o.cvCutIn&&(g=i)),r&&g<h&&(g=h),a&&(g=o.round(g)),f.setRelative(c,p,m*g,d),f.touch(c),exports.DEBUG&&console.log(o.step,(e?"MIRP[":"MDRP[")+(t?"M":"m")+(r?">":"_")+(a?"R":"_")+(0===n?"Gr":1===n?"Bl":2===n?"Wh":"")+"]",e?l+"("+o.cvt[l]+","+i+")":"",u,"(d =",s,"->",m*g,")"),o.rp1=o.rp0,o.rp2=u,t&&(o.rp0=u)}function Token(e){this.char=e,this.state={},this.activeState=null}function ContextRange(e,t,r){this.contextName=r,this.startIndex=e,this.endOffset=t}function ContextChecker(e,t,r){this.contextName=e,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=r}function ContextParams(e,t){this.context=e,this.index=t,this.length=e.length,this.current=e[t],this.backtrack=e.slice(0,t),this.lookahead=e.slice(t+1)}function Event(e){this.eventId=e,this.subscribers=[]}function initializeCoreEvents(r){var a=this,e=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];e.forEach(function(e){Object.defineProperty(a.events,e,{value:new Event(e)})}),r&&e.forEach(function(e){var t=r[e];"function"==typeof t&&a.events[e].subscribe(t)});["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach(function(e){a.events[e].subscribe(a.updateContextsRanges)})}function Tokenizer(e){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],initializeCoreEvents.call(this,e)}function isArabicChar(e){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(e)}function isIsolatedArabicChar(e){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(e)}function isTashkeelArabicChar(e){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(e)}function isLatinChar(e){return/[A-z]/.test(e)}function isWhiteSpace(e){return/\s/.test(e)}function FeatureQuery(e){this.font=e,this.features={}}function SubstitutionAction(e){this.id=e.id,this.tag=e.tag,this.substitution=e.substitution}function lookupCoverage(e,t){if(e)switch(t.format){case 1:return t.glyphs.indexOf(e);case 2:for(var r=t.ranges,a=0;a<r.length;a++){var n,o=r[a];if(e>=o.start&&e<=o.end)return n=e-o.start,o.index+n}break;default:return-1}return-1}function singleSubstitutionFormat1(e,t){return-1===lookupCoverage(e,t.coverage)?null:e+t.deltaGlyphId}function singleSubstitutionFormat2(e,t){e=lookupCoverage(e,t.coverage);return-1===e?null:t.substitute[e]}function lookupCoverageList(e,t){for(var r=[],a=0;a<e.length;a++){var n=e[a],o=t.current,o=lookupCoverage(o=Array.isArray(o)?o[0]:o,n);-1!==o&&r.push(o)}return r.length!==e.length?-1:r}function chainingSubstitutionFormat3(e,t){var r=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(e.context.length<r)return[];var a=lookupCoverageList(t.inputCoverage,e);if(-1===a)return[];r=t.inputCoverage.length-1;if(e.lookahead.length<t.lookaheadCoverage.length)return[];for(var n=e.lookahead.slice(r);n.length&&isTashkeelArabicChar(n[0].char);)n.shift();var r=new ContextParams(n,0),r=lookupCoverageList(t.lookaheadCoverage,r),o=[].concat(e.backtrack);for(o.reverse();o.length&&isTashkeelArabicChar(o[0].char);)o.shift();if(o.length<t.backtrackCoverage.length)return[];var s=new ContextParams(o,0),s=lookupCoverageList(t.backtrackCoverage,s),i=[];if(a.length===t.inputCoverage.length&&r.length===t.lookaheadCoverage.length&&s.length===t.backtrackCoverage.length)for(var u=0;u<t.lookupRecords.length;u++)for(var l=t.lookupRecords[u].lookupListIndex,p=this.getLookupByIndex(l),c=0;c<p.subtables.length;c++){var h=p.subtables[c],f=this.getLookupMethod(p,h);if("12"===this.getSubstitutionType(p,h))for(var d=0;d<a.length;d++){var g=f(e.get(d));g&&i.push(g)}}return i}function ligatureSubstitutionFormat1(e,t){var r=lookupCoverage(e.current,t.coverage);if(-1!==r)for(var a=t.ligatureSets[r],n=0;n<a.length;n++)for(var o=a[n],s=0;s<o.components.length;s++){if(e.lookahead[s]!==o.components[s])break;if(s===o.components.length-1)return o}return null}function decompositionSubstitutionFormat1(e,t){e=lookupCoverage(e,t.coverage);return-1===e?null:t.sequences[e]}function arabicWordStartCheck(e){var t=e.current,e=e.get(-1);return null===e&&isArabicChar(t)||!isArabicChar(e)&&isArabicChar(t)}function arabicWordEndCheck(e){e=e.get(1);return null===e||!isArabicChar(e)}Hinting.prototype.exec=function(e,t){if("number"!=typeof t)throw new Error("Point size is not a number!");if(!(2<this._errorState)){var r=this.font,a=this._prepState;if(!a||a.ppem!==t){var n=this._fpgmState;if(!n){State.prototype=defaultState,(n=this._fpgmState=new State("fpgm",r.tables.fpgm)).funcs=[],n.font=r,exports.DEBUG&&(console.log("---EXEC FPGM---"),n.step=-1);try{exec(n)}catch(e){return console.log("Hinting error in FPGM:"+e),void(this._errorState=3)}}State.prototype=n,(a=this._prepState=new State("prep",r.tables.prep)).ppem=t;var o=r.tables.cvt;if(o)for(var s=a.cvt=new Array(o.length),i=t/r.unitsPerEm,u=0;u<o.length;u++)s[u]=o[u]*i;else a.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),a.step=-1);try{exec(a)}catch(e){this._errorState<2&&console.log("Hinting error in PREP:"+e),this._errorState=2}}if(!(1<this._errorState))try{return execGlyph(e,a)}catch(e){this._errorState<1&&(console.log("Hinting error:"+e),console.log("Note: further hinting errors are silenced")),this._errorState=1}}},execGlyph=function(e,t){var r=t.ppem/t.font.unitsPerEm,a=r,n=e.components;if(State.prototype=t,n){for(var o=t.font,s=[],i=[],u=0;u<n.length;u++){var l=n[u],p=o.glyphs.get(l.glyphIndex),c=new State("glyf",p.instructions);exports.DEBUG&&(console.log("---EXEC COMP "+u+"---"),c.step=-1),execComponent(p,c,r,a);for(var h=Math.round(l.dx*r),f=Math.round(l.dy*a),d=c.gZone,g=c.contours,m=0;m<d.length;m++){var v=d[m];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+h,v.yo=v.y=v.y+f}var y=s.length;s.push.apply(s,d);for(var b=0;b<g.length;b++)i.push(g[b]+y)}e.instructions&&!c.inhibitGridFit&&((c=new State("glyf",e.instructions)).gZone=c.z0=c.z1=c.z2=s,c.contours=i,s.push(new HPoint(0,0),new HPoint(Math.round(e.advanceWidth*r),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),c.step=-1),exec(c),s.length-=2)}else c=new State("glyf",e.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),c.step=-1),execComponent(e,c,r,a),s=c.gZone;return s},execComponent=function(e,t,r,a){for(var n,o,s,i=e.points||[],u=i.length,l=t.gZone=t.z0=t.z1=t.z2=[],p=t.contours=[],c=0;c<u;c++)n=i[c],l[c]=new HPoint(n.x*r,n.y*a,n.lastPointOfContour,n.onCurve);for(var h=0;h<u;h++)n=l[h],o||(o=n,p.push(h)),n.lastPointOfContour?((n.nextPointOnContour=o).prevPointOnContour=n,o=void 0):(s=l[h+1],(n.nextPointOnContour=s).prevPointOnContour=n);if(!t.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(var f=0;f<u;f++)console.log(f,l[f].x,l[f].y)}if(l.push(new HPoint(0,0),new HPoint(Math.round(e.advanceWidth*r),0)),exec(t),l.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",t.stack);for(var d=0;d<u;d++)console.log(d,l[d].x,l[d].y)}}},exec=function(e){var t=e.prog;if(t){var r,a=t.length;for(e.ip=0;e.ip<a;e.ip++){if(exports.DEBUG&&e.step++,!(r=instructionTable[t[e.ip]]))throw new Error("unknown instruction: 0x"+Number(t[e.ip]).toString(16));r(e)}}},instructionTable=[SVTCA.bind(void 0,yUnitVector),SVTCA.bind(void 0,xUnitVector),SPVTCA.bind(void 0,yUnitVector),SPVTCA.bind(void 0,xUnitVector),SFVTCA.bind(void 0,yUnitVector),SFVTCA.bind(void 0,xUnitVector),SPVTL.bind(void 0,0),SPVTL.bind(void 0,1),SFVTL.bind(void 0,0),SFVTL.bind(void 0,1),SPVFS,SFVFS,GPV,GFV,SFVTPV,ISECT,SRP0,SRP1,SRP2,SZP0,SZP1,SZP2,SZPS,SLOOP,RTG,RTHG,SMD,ELSE,JMPR,SCVTCI,void 0,void 0,DUP,POP,CLEAR,SWAP,DEPTH,CINDEX,MINDEX,void 0,void 0,void 0,LOOPCALL,CALL,FDEF,void 0,MDAP.bind(void 0,0),MDAP.bind(void 0,1),IUP.bind(void 0,yUnitVector),IUP.bind(void 0,xUnitVector),SHP.bind(void 0,0),SHP.bind(void 0,1),SHC.bind(void 0,0),SHC.bind(void 0,1),SHZ.bind(void 0,0),SHZ.bind(void 0,1),SHPIX,IP,MSIRP.bind(void 0,0),MSIRP.bind(void 0,1),ALIGNRP,RTDG,MIAP.bind(void 0,0),MIAP.bind(void 0,1),NPUSHB,NPUSHW,WS,RS,WCVTP,RCVT,GC.bind(void 0,0),GC.bind(void 0,1),void 0,MD.bind(void 0,0),MD.bind(void 0,1),MPPEM,void 0,FLIPON,void 0,void 0,LT,LTEQ,GT,GTEQ,EQ,NEQ,ODD,EVEN,IF,EIF,AND,OR,NOT,DELTAP123.bind(void 0,1),SDB,SDS,ADD,SUB,DIV,MUL,ABS,NEG,FLOOR,CEILING,ROUND.bind(void 0,0),ROUND.bind(void 0,1),ROUND.bind(void 0,2),ROUND.bind(void 0,3),void 0,void 0,void 0,void 0,WCVTF,DELTAP123.bind(void 0,2),DELTAP123.bind(void 0,3),DELTAC123.bind(void 0,1),DELTAC123.bind(void 0,2),DELTAC123.bind(void 0,3),SROUND,S45ROUND,void 0,void 0,ROFF,void 0,RUTG,RDTG,POP,POP,void 0,void 0,void 0,void 0,void 0,SCANCTRL,SDPVTL.bind(void 0,0),SDPVTL.bind(void 0,1),GETINFO,void 0,ROLL,MAX,MIN,SCANTYPE,INSTCTRL,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,PUSHB.bind(void 0,1),PUSHB.bind(void 0,2),PUSHB.bind(void 0,3),PUSHB.bind(void 0,4),PUSHB.bind(void 0,5),PUSHB.bind(void 0,6),PUSHB.bind(void 0,7),PUSHB.bind(void 0,8),PUSHW.bind(void 0,1),PUSHW.bind(void 0,2),PUSHW.bind(void 0,3),PUSHW.bind(void 0,4),PUSHW.bind(void 0,5),PUSHW.bind(void 0,6),PUSHW.bind(void 0,7),PUSHW.bind(void 0,8),MDRP_MIRP.bind(void 0,0,0,0,0,0),MDRP_MIRP.bind(void 0,0,0,0,0,1),MDRP_MIRP.bind(void 0,0,0,0,0,2),MDRP_MIRP.bind(void 0,0,0,0,0,3),MDRP_MIRP.bind(void 0,0,0,0,1,0),MDRP_MIRP.bind(void 0,0,0,0,1,1),MDRP_MIRP.bind(void 0,0,0,0,1,2),MDRP_MIRP.bind(void 0,0,0,0,1,3),MDRP_MIRP.bind(void 0,0,0,1,0,0),MDRP_MIRP.bind(void 0,0,0,1,0,1),MDRP_MIRP.bind(void 0,0,0,1,0,2),MDRP_MIRP.bind(void 0,0,0,1,0,3),MDRP_MIRP.bind(void 0,0,0,1,1,0),MDRP_MIRP.bind(void 0,0,0,1,1,1),MDRP_MIRP.bind(void 0,0,0,1,1,2),MDRP_MIRP.bind(void 0,0,0,1,1,3),MDRP_MIRP.bind(void 0,0,1,0,0,0),MDRP_MIRP.bind(void 0,0,1,0,0,1),MDRP_MIRP.bind(void 0,0,1,0,0,2),MDRP_MIRP.bind(void 0,0,1,0,0,3),MDRP_MIRP.bind(void 0,0,1,0,1,0),MDRP_MIRP.bind(void 0,0,1,0,1,1),MDRP_MIRP.bind(void 0,0,1,0,1,2),MDRP_MIRP.bind(void 0,0,1,0,1,3),MDRP_MIRP.bind(void 0,0,1,1,0,0),MDRP_MIRP.bind(void 0,0,1,1,0,1),MDRP_MIRP.bind(void 0,0,1,1,0,2),MDRP_MIRP.bind(void 0,0,1,1,0,3),MDRP_MIRP.bind(void 0,0,1,1,1,0),MDRP_MIRP.bind(void 0,0,1,1,1,1),MDRP_MIRP.bind(void 0,0,1,1,1,2),MDRP_MIRP.bind(void 0,0,1,1,1,3),MDRP_MIRP.bind(void 0,1,0,0,0,0),MDRP_MIRP.bind(void 0,1,0,0,0,1),MDRP_MIRP.bind(void 0,1,0,0,0,2),MDRP_MIRP.bind(void 0,1,0,0,0,3),MDRP_MIRP.bind(void 0,1,0,0,1,0),MDRP_MIRP.bind(void 0,1,0,0,1,1),MDRP_MIRP.bind(void 0,1,0,0,1,2),MDRP_MIRP.bind(void 0,1,0,0,1,3),MDRP_MIRP.bind(void 0,1,0,1,0,0),MDRP_MIRP.bind(void 0,1,0,1,0,1),MDRP_MIRP.bind(void 0,1,0,1,0,2),MDRP_MIRP.bind(void 0,1,0,1,0,3),MDRP_MIRP.bind(void 0,1,0,1,1,0),MDRP_MIRP.bind(void 0,1,0,1,1,1),MDRP_MIRP.bind(void 0,1,0,1,1,2),MDRP_MIRP.bind(void 0,1,0,1,1,3),MDRP_MIRP.bind(void 0,1,1,0,0,0),MDRP_MIRP.bind(void 0,1,1,0,0,1),MDRP_MIRP.bind(void 0,1,1,0,0,2),MDRP_MIRP.bind(void 0,1,1,0,0,3),MDRP_MIRP.bind(void 0,1,1,0,1,0),MDRP_MIRP.bind(void 0,1,1,0,1,1),MDRP_MIRP.bind(void 0,1,1,0,1,2),MDRP_MIRP.bind(void 0,1,1,0,1,3),MDRP_MIRP.bind(void 0,1,1,1,0,0),MDRP_MIRP.bind(void 0,1,1,1,0,1),MDRP_MIRP.bind(void 0,1,1,1,0,2),MDRP_MIRP.bind(void 0,1,1,1,0,3),MDRP_MIRP.bind(void 0,1,1,1,1,0),MDRP_MIRP.bind(void 0,1,1,1,1,1),MDRP_MIRP.bind(void 0,1,1,1,1,2),MDRP_MIRP.bind(void 0,1,1,1,1,3)],Token.prototype.setState=function(e,t){return this.state[e]=t,this.activeState={key:e,value:this.state[e]},this.activeState},Token.prototype.getState=function(e){return this.state[e]||null},Tokenizer.prototype.inboundIndex=function(e){return 0<=e&&e<this.tokens.length},Tokenizer.prototype.composeRUD=function(e){function t(e){return"object"==typeof e&&e.hasOwnProperty("FAIL")}var r=this,e=e.map(function(e){return r[e[0]].apply(r,e.slice(1).concat(!0))});if(e.every(t))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:e.filter(t)};this.dispatch("composeRUD",[e.filter(function(e){return!t(e)})])},Tokenizer.prototype.replaceRange=function(e,t,r,a){t=null!==t?t:this.tokens.length;var n=r.every(function(e){return e instanceof Token});return!isNaN(e)&&this.inboundIndex(e)&&n?(n=this.tokens.splice.apply(this.tokens,[e,t].concat(r)),a||this.dispatch("replaceToken",[e,t,r]),[n,r]):{FAIL:"replaceRange: invalid tokens or startIndex."}},Tokenizer.prototype.replaceToken=function(e,t,r){var a;return!isNaN(e)&&this.inboundIndex(e)&&t instanceof Token?(a=this.tokens.splice(e,1,t),r||this.dispatch("replaceToken",[e,t]),[a[0],t]):{FAIL:"replaceToken: invalid token or index."}},Tokenizer.prototype.removeRange=function(e,t,r){t=isNaN(t)?this.tokens.length:t;var a=this.tokens.splice(e,t);return r||this.dispatch("removeRange",[a,e,t]),a},Tokenizer.prototype.removeToken=function(e,t){var r;return!isNaN(e)&&this.inboundIndex(e)?(r=this.tokens.splice(e,1),t||this.dispatch("removeToken",[r,e]),r):{FAIL:"removeToken: invalid token index."}},Tokenizer.prototype.insertToken=function(e,t,r){return e.every(function(e){return e instanceof Token})?(this.tokens.splice.apply(this.tokens,[t,0].concat(e)),r||this.dispatch("insertToken",[e,t]),e):{FAIL:"insertToken: invalid token(s)."}},Tokenizer.prototype.registerModifier=function(r,a,n){this.events.newToken.subscribe(function(e,t){null!==a&&!0!==a.apply(this,[e,t])||(t=n.apply(this,[e,t]),e.setState(r,t))}),this.registeredModifiers.push(r)},Event.prototype.subscribe=function(e){return"function"==typeof e?this.subscribers.push(e)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Event.prototype.unsubscribe=function(e){this.subscribers.splice(e,1)},ContextParams.prototype.setCurrentIndex=function(e){this.index=e,this.current=this.context[e],this.backtrack=this.context.slice(0,e),this.lookahead=this.context.slice(e+1)},ContextParams.prototype.get=function(e){switch(!0){case 0===e:return this.current;case e<0&&Math.abs(e)<=this.backtrack.length:return this.backtrack.slice(e)[0];case 0<e&&e<=this.lookahead.length:return this.lookahead[e-1];default:return null}},Tokenizer.prototype.rangeToText=function(e){if(e instanceof ContextRange)return this.getRangeTokens(e).map(function(e){return e.char}).join("")},Tokenizer.prototype.getText=function(){return this.tokens.map(function(e){return e.char}).join("")},Tokenizer.prototype.getContext=function(e){e=this.registeredContexts[e];return e||null},Tokenizer.prototype.on=function(e,t){e=this.events[e];return e?e.subscribe(t):null},Tokenizer.prototype.dispatch=function(e,t){var r=this,e=this.events[e];e instanceof Event&&e.subscribers.forEach(function(e){e.apply(r,t||[])})},Tokenizer.prototype.registerContextChecker=function(e,t,r){return this.getContext(e)?{FAIL:"context name '"+e+"' is already registered."}:"function"!=typeof t?{FAIL:"missing context start check."}:"function"!=typeof r?{FAIL:"missing context end check."}:(t=new ContextChecker(e,t,r),this.registeredContexts[e]=t,this.contextCheckers.push(t),t)},Tokenizer.prototype.getRangeTokens=function(e){var t=e.startIndex+e.endOffset;return[].concat(this.tokens.slice(e.startIndex,t))},Tokenizer.prototype.getContextRanges=function(e){var t=this.getContext(e);return t?t.ranges:{FAIL:"context checker '"+e+"' is not registered."}},Tokenizer.prototype.resetContextsRanges=function(){var e,t=this.registeredContexts;for(e in t)t.hasOwnProperty(e)&&(t[e].ranges=[])},Tokenizer.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var e=this.tokens.map(function(e){return e.char}),t=0;t<e.length;t++){var r=new ContextParams(e,t);this.runContextCheck(r)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Tokenizer.prototype.setEndOffset=function(e,t){var e=new ContextRange(this.getContext(t).openRange.startIndex,e,t),r=this.getContext(t).ranges;return e.rangeId=t+"."+r.length,r.push(e),this.getContext(t).openRange=null,e},Tokenizer.prototype.runContextCheck=function(a){var n=this,o=a.index;this.contextCheckers.forEach(function(e){var t=e.contextName,r=n.getContext(t).openRange;!r&&e.checkStart(a)&&(r=new ContextRange(o,null,t),n.getContext(t).openRange=r,n.dispatch("contextStart",[t,o])),r&&e.checkEnd(a)&&(e=o-r.startIndex+1,r=n.setEndOffset(e,t),n.dispatch("contextEnd",[t,r]))})},Tokenizer.prototype.tokenize=function(e){this.tokens=[],this.resetContextsRanges();var t=Array.from(e);this.dispatch("start");for(var r=0;r<t.length;r++){var a=t[r],n=new ContextParams(t,r),a=(this.dispatch("next",[n]),this.runContextCheck(n),new Token(a));this.tokens.push(a),this.dispatch("newToken",[a,n])}return this.dispatch("end",[this.tokens]),this.tokens},FeatureQuery.prototype.getDefaultScriptFeaturesIndexes=function(){for(var e=this.font.tables.gsub.scripts,t=0;t<e.length;t++){var r=e[t];if("DFLT"===r.tag)return r.script.defaultLangSys.featureIndexes}return[]},FeatureQuery.prototype.getScriptFeaturesIndexes=function(e){if(!this.font.tables.gsub)return[];if(e)for(var t=this.font.tables.gsub.scripts,r=0;r<t.length;r++){var a=t[r];if(a.tag===e&&a.script.defaultLangSys)return a.script.defaultLangSys.featureIndexes;var n=a.langSysRecords;if(n)for(var o=0;o<n.length;o++){var s=n[o];if(s.tag===e)return s.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},FeatureQuery.prototype.mapTagsToFeatures=function(e,t){for(var r={},a=0;a<e.length;a++){var n=e[a].tag,o=e[a].feature;r[n]=o}this.features[t].tags=r},FeatureQuery.prototype.getScriptFeatures=function(e){var t=this.features[e];if(!this.features.hasOwnProperty(e)){var r=this.getScriptFeaturesIndexes(e);if(!r)return null;var a=this.font.tables.gsub,t=r.map(function(e){return a.features[e]});this.features[e]=t,this.mapTagsToFeatures(t,e)}return t},FeatureQuery.prototype.getSubstitutionType=function(e,t){return e.lookupType.toString()+t.substFormat.toString()},FeatureQuery.prototype.getLookupMethod=function(e,t){var r=this;switch(this.getSubstitutionType(e,t)){case"11":return function(e){return singleSubstitutionFormat1.apply(r,[e,t])};case"12":return function(e){return singleSubstitutionFormat2.apply(r,[e,t])};case"63":return function(e){return chainingSubstitutionFormat3.apply(r,[e,t])};case"41":return function(e){return ligatureSubstitutionFormat1.apply(r,[e,t])};case"21":return function(e){return decompositionSubstitutionFormat1.apply(r,[e,t])};default:throw new Error("lookupType: "+e.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}},FeatureQuery.prototype.lookupFeature=function(e){var t=e.contextParams,r=t.index,a=this.getFeature({tag:e.tag,script:e.script});if(!a)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+e.tag+"' for script '"+e.script+"'.");for(var n=this.getFeatureLookups(a),o=[].concat(t.context),s=0;s<n.length;s++)for(var i=n[s],u=this.getLookupSubtables(i),l=0;l<u.length;l++){var p=u[l],c=this.getSubstitutionType(i,p),h=this.getLookupMethod(i,p),f=void 0;switch(c){case"11":(f=h(t.current))&&o.splice(r,1,new SubstitutionAction({id:11,tag:e.tag,substitution:f}));break;case"12":(f=h(t.current))&&o.splice(r,1,new SubstitutionAction({id:12,tag:e.tag,substitution:f}));break;case"63":f=h(t),Array.isArray(f)&&f.length&&o.splice(r,1,new SubstitutionAction({id:63,tag:e.tag,substitution:f}));break;case"41":(f=h(t))&&o.splice(r,1,new SubstitutionAction({id:41,tag:e.tag,substitution:f}));break;case"21":(f=h(t.current))&&o.splice(r,1,new SubstitutionAction({id:21,tag:e.tag,substitution:f}))}t=new ContextParams(o,r),Array.isArray(f)&&!f.length||(f=null)}return o.length?o:null},FeatureQuery.prototype.supports=function(t){if(!t.script)return!1;this.getScriptFeatures(t.script);var e,r=this.features.hasOwnProperty(t.script);return t.tag?(e=this.features[t.script].some(function(e){return e.tag===t.tag}),r&&e):r},FeatureQuery.prototype.getLookupSubtables=function(e){return e.subtables||null},FeatureQuery.prototype.getLookupByIndex=function(e){return this.font.tables.gsub.lookups[e]||null},FeatureQuery.prototype.getFeatureLookups=function(e){return e.lookupListIndexes.map(this.getLookupByIndex.bind(this))},FeatureQuery.prototype.getFeature=function(e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(e.script)||this.getScriptFeatures(e.script);var t=this.features[e.script];return t?t.tags[e.tag]?this.features[e.script].tags[e.tag]:null:{FAIL:"No feature for script "+e.script}};var arabicWordCheck={startCheck:arabicWordStartCheck,endCheck:arabicWordEndCheck};function arabicSentenceStartCheck(e){var t=e.current,e=e.get(-1);return(isArabicChar(t)||isTashkeelArabicChar(t))&&!isArabicChar(e)}function arabicSentenceEndCheck(e){var t=e.get(1);switch(!0){case null===t:return!0;case!isArabicChar(t)&&!isTashkeelArabicChar(t):var r=isWhiteSpace(t);if(!r)return!0;if(r)if(!e.lookahead.some(function(e){return isArabicChar(e)||isTashkeelArabicChar(e)}))return!0;break;default:return!1}}var arabicSentenceCheck={startCheck:arabicSentenceStartCheck,endCheck:arabicSentenceEndCheck};function singleSubstitutionFormat1$1(e,t,r){t[r].setState(e.tag,e.substitution)}function singleSubstitutionFormat2$1(e,t,r){t[r].setState(e.tag,e.substitution)}function chainingSubstitutionFormat3$1(r,a,n){r.substitution.forEach(function(e,t){a[n+t].setState(r.tag,e)})}function ligatureSubstitutionFormat1$1(e,t,r){for(var a=t[r],n=(a.setState(e.tag,e.substitution.ligGlyph),e.substitution.components.length),o=0;o<n;o++)(a=t[r+o+1]).setState("deleted",!0)}var SUBSTITUTIONS={11:singleSubstitutionFormat1$1,12:singleSubstitutionFormat2$1,63:chainingSubstitutionFormat3$1,41:ligatureSubstitutionFormat1$1};function applySubstitution(e,t,r){e instanceof SubstitutionAction&&SUBSTITUTIONS[e.id]&&SUBSTITUTIONS[e.id](e,t,r)}function willConnectPrev(e){for(var t=[].concat(e.backtrack),r=t.length-1;0<=r;r--){var a=t[r],n=isIsolatedArabicChar(a),a=isTashkeelArabicChar(a);if(!n&&!a)return!0;if(n)return!1}return!1}function willConnectNext(e){if(!isIsolatedArabicChar(e.current))for(var t=0;t<e.lookahead.length;t++)if(!isTashkeelArabicChar(e.lookahead[t]))return!0;return!1}function arabicPresentationForms(e){var a,n,o=this,s=this.featuresTags.arab,i=this.tokenizer.getRangeTokens(e);1!==i.length&&(a=new ContextParams(i.map(function(e){return e.getState("glyphIndex")}),0),n=new ContextParams(i.map(function(e){return e.char}),0),i.forEach(function(e,t){if(!isTashkeelArabicChar(e.char)){a.setCurrentIndex(t),n.setCurrentIndex(t);var r,e=0;switch(willConnectPrev(n)&&(e|=1),willConnectNext(n)&&(e|=2),e){case 1:r="fina";break;case 2:r="init";break;case 3:r="medi"}if(-1!==s.indexOf(r))return(t=o.query.lookupFeature({tag:r,script:"arab",contextParams:a}))instanceof Error?console.info(t.message):void t.forEach(function(e,t){e instanceof SubstitutionAction&&(applySubstitution(e,i,t),a.context[t]=e.substitution)})}}))}function getContextParams(e,t){return new ContextParams(e.map(function(e){return e.activeState.value}),t||0)}function arabicRequiredLigatures(e){var a=this,n=this.tokenizer.getRangeTokens(e),o=getContextParams(n);o.context.forEach(function(e,t){o.setCurrentIndex(t);var r=a.query.lookupFeature({tag:"rlig",script:"arab",contextParams:o});r.length&&(r.forEach(function(e){return applySubstitution(e,n,t)}),o=getContextParams(n))})}function latinWordStartCheck(e){var t=e.current,e=e.get(-1);return null===e&&isLatinChar(t)||!isLatinChar(e)&&isLatinChar(t)}function latinWordEndCheck(e){e=e.get(1);return null===e||!isLatinChar(e)}var latinWordCheck={startCheck:latinWordStartCheck,endCheck:latinWordEndCheck};function getContextParams$1(e,t){return new ContextParams(e.map(function(e){return e.activeState.value}),t||0)}function latinLigature(e){var a=this,n=this.tokenizer.getRangeTokens(e),o=getContextParams$1(n);o.context.forEach(function(e,t){o.setCurrentIndex(t);var r=a.query.lookupFeature({tag:"liga",script:"latn",contextParams:o});r.length&&(r.forEach(function(e){return applySubstitution(e,n,t)}),o=getContextParams$1(n))})}function Bidi(e){this.baseDir=e||"ltr",this.tokenizer=new Tokenizer,this.featuresTags={}}function registerContextChecker(e){var t=this.contextChecks[e+"Check"];return this.tokenizer.registerContextChecker(e,t.startCheck,t.endCheck)}function tokenizeText(){return registerContextChecker.call(this,"latinWord"),registerContextChecker.call(this,"arabicWord"),registerContextChecker.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function reverseArabicSentences(){var r=this;this.tokenizer.getContextRanges("arabicSentence").forEach(function(e){var t=r.tokenizer.getRangeTokens(e);r.tokenizer.replaceRange(e.startIndex,e.endOffset,t.reverse())})}function checkGlyphIndexStatus(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function applyArabicPresentationForms(){var t=this;this.featuresTags.hasOwnProperty("arab")&&(checkGlyphIndexStatus.call(this),this.tokenizer.getContextRanges("arabicWord").forEach(function(e){arabicPresentationForms.call(t,e)}))}function applyArabicRequireLigatures(){var t=this;this.featuresTags.hasOwnProperty("arab")&&-1!==this.featuresTags.arab.indexOf("rlig")&&(checkGlyphIndexStatus.call(this),this.tokenizer.getContextRanges("arabicWord").forEach(function(e){arabicRequiredLigatures.call(t,e)}))}function applyLatinLigatures(){var t=this;this.featuresTags.hasOwnProperty("latn")&&-1!==this.featuresTags.latn.indexOf("liga")&&(checkGlyphIndexStatus.call(this),this.tokenizer.getContextRanges("latinWord").forEach(function(e){latinLigature.call(t,e)}))}function Font(e){(e=e||{}).tables=e.tables||{},e.empty||(checkArgument(e.familyName,"When creating a new Font object, familyName is required."),checkArgument(e.styleName,"When creating a new Font object, styleName is required."),checkArgument(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),checkArgument(e.ascender,"When creating a new Font object, ascender is required."),checkArgument(e.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables=Object.assign(e.tables,{os2:Object.assign({usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR},e.tables.os2)})),this.supported=!0,this.glyphs=new glyphset.GlyphSet(this,e.glyphs||[]),this.encoding=new DefaultEncoding(this),this.position=new Position(this),this.substitution=new Substitution(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting||("truetype"===this.outlinesFormat?this._hinting=new Hinting(this):void 0)}})}function addName(e,t){var r,a=JSON.stringify(e),n=256;for(r in t){var o=parseInt(r);if(o&&!(o<256)){if(JSON.stringify(t[r])===a)return o;n<=o&&(n=o+1)}}return t[n]=e,n}function makeFvarAxis(e,t,r){r=addName(t.name,r);return[{name:"tag_"+e,type:"TAG",value:t.tag},{name:"minValue_"+e,type:"FIXED",value:t.minValue<<16},{name:"defaultValue_"+e,type:"FIXED",value:t.defaultValue<<16},{name:"maxValue_"+e,type:"FIXED",value:t.maxValue<<16},{name:"flags_"+e,type:"USHORT",value:0},{name:"nameID_"+e,type:"USHORT",value:r}]}function parseFvarAxis(e,t,r){var a={},e=new parse.Parser(e,t);return a.tag=e.parseTag(),a.minValue=e.parseFixed(),a.defaultValue=e.parseFixed(),a.maxValue=e.parseFixed(),e.skip("uShort",1),a.name=r[e.parseUShort()]||{},a}function makeFvarInstance(e,t,r,a){for(var n=[{name:"nameID_"+e,type:"USHORT",value:addName(t.name,a)},{name:"flags_"+e,type:"USHORT",value:0}],o=0;o<r.length;++o){var s=r[o].tag;n.push({name:"axis_"+e+" "+s,type:"FIXED",value:t.coordinates[s]<<16})}return n}function parseFvarInstance(e,t,r,a){var n={},o=new parse.Parser(e,t);n.name=a[o.parseUShort()]||{},o.skip("uShort",1),n.coordinates={};for(var s=0;s<r.length;++s)n.coordinates[r[s].tag]=o.parseFixed();return n}function makeFvarTable(e,t){var r=new table.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);r.offsetToData=r.sizeOf();for(var a=0;a<e.axes.length;a++)r.fields=r.fields.concat(makeFvarAxis(a,e.axes[a],t));for(var n=0;n<e.instances.length;n++)r.fields=r.fields.concat(makeFvarInstance(n,e.instances[n],e.axes,t));return r}function parseFvarTable(e,t,r){for(var a=new parse.Parser(e,t),n=a.parseULong(),o=(check.argument(65536===n,"Unsupported fvar table version."),a.parseOffset16()),s=(a.skip("uShort",1),a.parseUShort()),i=a.parseUShort(),u=a.parseUShort(),l=a.parseUShort(),p=[],c=0;c<s;c++)p.push(parseFvarAxis(e,t+o+c*i,r));for(var h=[],f=t+o+s*i,d=0;d<u;d++)h.push(parseFvarInstance(e,f+d*l,p,r));return{axes:p,instances:h}}Bidi.prototype.setText=function(e){this.text=e},Bidi.prototype.contextChecks={latinWordCheck:latinWordCheck,arabicWordCheck:arabicWordCheck,arabicSentenceCheck:arabicSentenceCheck},Bidi.prototype.registerFeatures=function(t,e){var r=this,e=e.filter(function(e){return r.query.supports({script:t,tag:e})});this.featuresTags.hasOwnProperty(t)?this.featuresTags[t]=this.featuresTags[t].concat(e):this.featuresTags[t]=e},Bidi.prototype.applyFeatures=function(e,t){if(!e)throw new Error("No valid font was provided to apply features");this.query||(this.query=new FeatureQuery(e));for(var r=0;r<t.length;r++){var a=t[r];this.query.supports({script:a.script})&&this.registerFeatures(a.script,a.tags)}},Bidi.prototype.registerModifier=function(e,t,r){this.tokenizer.registerModifier(e,t,r)},Bidi.prototype.checkContextReady=function(e){return!!this.tokenizer.getContext(e)},Bidi.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(applyArabicPresentationForms.call(this),applyArabicRequireLigatures.call(this)),this.checkContextReady("latinWord")&&applyLatinLigatures.call(this),this.checkContextReady("arabicSentence")&&reverseArabicSentences.call(this)},Bidi.prototype.processText=function(e){this.text&&this.text===e||(this.setText(e),tokenizeText.call(this),this.applyFeaturesToContexts())},Bidi.prototype.getBidiText=function(e){return this.processText(e),this.tokenizer.getText()},Bidi.prototype.getTextGlyphs=function(e){this.processText(e);for(var t=[],r=0;r<this.tokenizer.tokens.length;r++){var a=this.tokenizer.tokens[r];a.state.deleted||(a=a.activeState.value,t.push(Array.isArray(a)?a[0]:a))}return t},Font.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},Font.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},Font.prototype.charToGlyph=function(e){e=this.charToGlyphIndex(e);return this.glyphs.get(e)||this.glyphs.get(0)},Font.prototype.updateFeatures=function(t){return this.defaultRenderOptions.features.map(function(e){return"latn"===e.script?{script:"latn",tags:e.tags.filter(function(e){return t[e]})}:e})},Font.prototype.stringToGlyphs=function(e,t){for(var r=this,a=new Bidi,t=(a.registerModifier("glyphIndex",null,function(e){return r.charToGlyphIndex(e.char)}),t?this.updateFeatures(t.features):this.defaultRenderOptions.features),n=(a.applyFeatures(this,t),a.getTextGlyphs(e)),o=n.length,s=new Array(o),i=this.glyphs.get(0),u=0;u<o;u+=1)s[u]=this.glyphs.get(n[u])||i;return s},Font.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},Font.prototype.nameToGlyph=function(e){e=this.nameToGlyphIndex(e);return this.glyphs.get(e)||this.glyphs.get(0)},Font.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},Font.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,e,t):this.kerningPairs[e+","+t]||0},Font.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},Font.prototype.forEachGlyph=function(e,t,r,a,n,o){t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:72,n=Object.assign({},this.defaultRenderOptions,n);var s,i=1/this.unitsPerEm*a,u=this.stringToGlyphs(e,n);n.kerning&&(e=n.script||this.position.getDefaultScriptName(),s=this.position.getKerningTables(e,n.language));for(var l=0;l<u.length;l+=1){var p=u[l];o.call(this,p,t,r,a,n),p.advanceWidth&&(t+=p.advanceWidth*i),n.kerning&&l<u.length-1&&(t+=(s?this.position.getKerningValue(s,p.index,u[l+1].index):this.getKerningValue(p,u[l+1]))*i),n.letterSpacing?t+=n.letterSpacing*a:n.tracking&&(t+=n.tracking/1e3*a)}return t},Font.prototype.getPath=function(e,t,r,a,n){var o=new Path;return this.forEachGlyph(e,t,r,a,n,function(e,t,r,a){e=e.getPath(t,r,a,n,this);o.extend(e)}),o},Font.prototype.getPaths=function(e,t,r,a,n){var o=[];return this.forEachGlyph(e,t,r,a,n,function(e,t,r,a){e=e.getPath(t,r,a,n,this);o.push(e)}),o},Font.prototype.getAdvanceWidth=function(e,t,r){return this.forEachGlyph(e,0,0,t,r,function(){})},Font.prototype.draw=function(e,t,r,a,n,o){this.getPath(t,r,a,n,o).draw(e)},Font.prototype.drawPoints=function(n,e,t,r,a,o){this.forEachGlyph(e,t,r,a,o,function(e,t,r,a){e.drawPoints(n,t,r,a)})},Font.prototype.drawMetrics=function(n,e,t,r,a,o){this.forEachGlyph(e,t,r,a,o,function(e,t,r,a){e.drawMetrics(n,t,r,a)})},Font.prototype.getEnglishName=function(e){e=this.names[e];if(e)return e.en},Font.prototype.validate=function(){var t=this;function e(e){e=t.getEnglishName(e);e&&e.trim().length}e("fontFamily"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),this.unitsPerEm},Font.prototype.toTables=function(){return sfnt.fontToTable(this)},Font.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},Font.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a<e.length;a++)r[a]=e[a];return t},Font.prototype.download=function(e){var t,r=this.getEnglishName("fontFamily"),a=this.getEnglishName("fontSubfamily"),r=(e=e||r.replace(/\s/g,"")+"-"+a+".otf",this.toArrayBuffer());isBrowser()?(window.URL=window.URL||window.webkitURL,window.URL?(a=new DataView(r),a=new Blob([a],{type:"font/opentype"}),(t=document.createElement("a")).href=window.URL.createObjectURL(a),t.download=e,(a=document.createEvent("MouseEvents")).initEvent("click",!0,!1),t.dispatchEvent(a)):console.warn("Font file could not be downloaded. Try using a different browser.")):(t=require("fs"),a=arrayBufferToNodeBuffer(r),t.writeFileSync(e,a))},Font.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},Font.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},Font.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var fvar={make:makeFvarTable,parse:parseFvarTable},attachList=function(){return{coverage:this.parsePointer(Parser.coverage),attachPoints:this.parseList(Parser.pointer(Parser.uShortList))}},caretValue=function(){var e=this.parseUShort();return check.argument(1===e||2===e||3===e,"Unsupported CaretValue table version."),1===e?{coordinate:this.parseShort()}:2===e?{pointindex:this.parseShort()}:3===e?{coordinate:this.parseShort()}:void 0},ligGlyph=function(){return this.parseList(Parser.pointer(caretValue))},ligCaretList=function(){return{coverage:this.parsePointer(Parser.coverage),ligGlyphs:this.parseList(Parser.pointer(ligGlyph))}},markGlyphSets=function(){return this.parseUShort(),this.parseList(Parser.pointer(Parser.coverage))};function parseGDEFTable(e,t){var e=new Parser(e,t=t||0),t=e.parseVersion(1),r=(check.argument(1===t||1.2===t||1.3===t,"Unsupported GDEF table version."),{version:t,classDef:e.parsePointer(Parser.classDef),attachList:e.parsePointer(attachList),ligCaretList:e.parsePointer(ligCaretList),markAttachClassDef:e.parsePointer(Parser.classDef)});return 1.2<=t&&(r.markGlyphSets=e.parsePointer(markGlyphSets)),r}var gdef={parse:parseGDEFTable},subtableParsers$1=new Array(10);function parseGposTable(e,t){e=new Parser(e,t=t||0),t=e.parseVersion(1);return check.argument(1===t||1.1===t,"Unsupported GPOS table version "+t),1===t?{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(subtableParsers$1)}:{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(subtableParsers$1),variations:e.parseFeatureVariationsList()}}subtableParsers$1[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(Parser.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(Parser.coverage),values:this.parseValueRecordList()}:void check.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},subtableParsers$1[2]=function(){var e,t,r,a,n=this.offset+this.relativeOffset,o=this.parseUShort(),n=(check.assert(1===o||2===o,"0x"+n.toString(16)+": GPOS lookup type 2 format must be 1 or 2."),this.parsePointer(Parser.coverage)),s=this.parseUShort(),i=this.parseUShort();return 1===o?{posFormat:o,coverage:n,valueFormat1:s,valueFormat2:i,pairSets:this.parseList(Parser.pointer(Parser.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(s),value2:this.parseValueRecord(i)}})))}:2===o?(e=this.parsePointer(Parser.classDef),t=this.parsePointer(Parser.classDef),r=this.parseUShort(),a=this.parseUShort(),{posFormat:o,coverage:n,valueFormat1:s,valueFormat2:i,classDef1:e,classDef2:t,class1Count:r,class2Count:a,classRecords:this.parseList(r,Parser.list(a,function(){return{value1:this.parseValueRecord(s),value2:this.parseValueRecord(i)}}))}):void 0},subtableParsers$1[3]=function(){return{error:"GPOS Lookup 3 not supported"}},subtableParsers$1[4]=function(){return{error:"GPOS Lookup 4 not supported"}},subtableParsers$1[5]=function(){return{error:"GPOS Lookup 5 not supported"}},subtableParsers$1[6]=function(){return{error:"GPOS Lookup 6 not supported"}},subtableParsers$1[7]=function(){return{error:"GPOS Lookup 7 not supported"}},subtableParsers$1[8]=function(){return{error:"GPOS Lookup 8 not supported"}},subtableParsers$1[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var subtableMakers$1=new Array(10);function makeGposTable(e){return new table.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new table.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new table.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new table.LookupList(e.lookups,subtableMakers$1)}])}var gpos={parse:parseGposTable,make:makeGposTable};function parseWindowsKernTable(e){var t={},r=(e.skip("uShort"),e.parseUShort()),a=(check.argument(0===r,"Unsupported kern sub-table version."),e.skip("uShort",2),e.parseUShort());e.skip("uShort",3);for(var n=0;n<a;n+=1){var o=e.parseUShort(),s=e.parseUShort(),i=e.parseShort();t[o+","+s]=i}return t}function parseMacKernTable(e){var t={};e.skip("uShort"),1<e.parseULong()&&console.warn("Only the first kern subtable is supported."),e.skip("uLong");var r=255&e.parseUShort();if(e.skip("uShort"),0==r){var a=e.parseUShort();e.skip("uShort",3);for(var n=0;n<a;n+=1){var o=e.parseUShort(),s=e.parseUShort(),i=e.parseShort();t[o+","+s]=i}}return t}function parseKernTable(e,t){e=new parse.Parser(e,t),t=e.parseUShort();if(0===t)return parseWindowsKernTable(e);if(1===t)return parseMacKernTable(e);throw new Error("Unsupported kern table version ("+t+").")}var kern={parse:parseKernTable};function parseLocaTable(e,t,r,a){for(var n=new parse.Parser(e,t),o=a?n.parseUShort:n.parseULong,s=[],i=0;i<r+1;i+=1){var u=o.call(n);a&&(u*=2),s.push(u)}return s}var loca={parse:parseLocaTable};function loadFromFile(e,r){require("fs").readFile(e,function(e,t){if(e)return r(e.message);r(null,nodeBufferToArrayBuffer(t))})}function loadFromUrl(e,t){var r=new XMLHttpRequest;r.open("get",e,!0),r.responseType="arraybuffer",r.onload=function(){return r.response?t(null,r.response):t("Font could not be loaded: "+r.statusText)},r.onerror=function(){t("Font could not be loaded")},r.send()}function parseOpenTypeTableEntries(e,t){for(var r=[],a=12,n=0;n<t;n+=1){var o=parse.getTag(e,a),s=parse.getULong(e,a+4),i=parse.getULong(e,a+8),u=parse.getULong(e,a+12);r.push({tag:o,checksum:s,offset:i,length:u,compression:!1}),a+=16}return r}function parseWOFFTableEntries(e,t){for(var r=[],a=44,n=0;n<t;n+=1){var o=parse.getTag(e,a),s=parse.getULong(e,a+4),i=parse.getULong(e,a+8),u=parse.getULong(e,a+12),l=void 0,l=i<u&&"WOFF";r.push({tag:o,offset:s,compression:l,compressedLength:i,length:u}),a+=20}return r}function uncompressTable(e,t){if("WOFF"!==t.compression)return{data:e,offset:t.offset};var e=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),r=new Uint8Array(t.length);if(tinyInflate(e,r),r.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}function parseBuffer(e,t){t=null==t?{}:t;var r,a,n,o,s,i,u,l,p,c,h,f,d,g,m,v=new Font({empty:!0}),y=new DataView(e,0),b=[],e=parse.getTag(y,0);if(e===String.fromCharCode(0,1,0,0)||"true"===e||"typ1"===e)v.outlinesFormat="truetype",b=parseOpenTypeTableEntries(y,n=parse.getUShort(y,4));else if("OTTO"===e)v.outlinesFormat="cff",b=parseOpenTypeTableEntries(y,n=parse.getUShort(y,4));else{if("wOFF"!==e)throw new Error("Unsupported OpenType signature "+e);var S=parse.getTag(y,4);if(S===String.fromCharCode(0,1,0,0))v.outlinesFormat="truetype";else{if("OTTO"!==S)throw new Error("Unsupported OpenType flavor "+e);v.outlinesFormat="cff"}b=parseWOFFTableEntries(y,n=parse.getUShort(y,12))}for(var T=0;T<n;T+=1){var x=b[T],k=void 0;switch(x.tag){case"cmap":k=uncompressTable(y,x),v.tables.cmap=cmap.parse(k.data,k.offset),v.encoding=new CmapEncoding(v.tables.cmap);break;case"cvt ":k=uncompressTable(y,x),m=new parse.Parser(k.data,k.offset),v.tables.cvt=m.parseShortList(x.length/2);break;case"fvar":s=x;break;case"fpgm":k=uncompressTable(y,x),m=new parse.Parser(k.data,k.offset),v.tables.fpgm=m.parseByteList(x.length);break;case"head":k=uncompressTable(y,x),v.tables.head=head.parse(k.data,k.offset),v.unitsPerEm=v.tables.head.unitsPerEm,r=v.tables.head.indexToLocFormat;break;case"hhea":k=uncompressTable(y,x),v.tables.hhea=hhea.parse(k.data,k.offset),v.ascender=v.tables.hhea.ascender,v.descender=v.tables.hhea.descender,v.numberOfHMetrics=v.tables.hhea.numberOfHMetrics;break;case"hmtx":c=x;break;case"ltag":k=uncompressTable(y,x),a=ltag.parse(k.data,k.offset);break;case"maxp":k=uncompressTable(y,x),v.tables.maxp=maxp.parse(k.data,k.offset),v.numGlyphs=v.tables.maxp.numGlyphs;break;case"name":d=x;break;case"OS/2":k=uncompressTable(y,x),v.tables.os2=os2.parse(k.data,k.offset);break;case"post":k=uncompressTable(y,x),v.tables.post=post.parse(k.data,k.offset),v.glyphNames=new GlyphNames(v.tables.post);break;case"prep":k=uncompressTable(y,x),m=new parse.Parser(k.data,k.offset),v.tables.prep=m.parseByteList(x.length);break;case"glyf":i=x;break;case"loca":f=x;break;case"CFF ":o=x;break;case"kern":h=x;break;case"GDEF":u=x;break;case"GPOS":l=x;break;case"GSUB":p=x;break;case"meta":g=x}}S=uncompressTable(y,d);if(v.tables.name=_name.parse(S.data,S.offset,a),v.names=v.tables.name,i&&f){e=0===r,S=uncompressTable(y,f),S=loca.parse(S.data,S.offset,v.numGlyphs,e),e=uncompressTable(y,i);v.glyphs=glyf.parse(e.data,e.offset,S,v,t)}else{if(!o)throw new Error("Font doesn't contain TrueType or CFF outlines.");e=uncompressTable(y,o);cff.parse(e.data,e.offset,v,t)}var S=uncompressTable(y,c);return hmtx.parse(v,S.data,S.offset,v.numberOfHMetrics,v.numGlyphs,v.glyphs,t),addGlyphNames(v,t),h?(e=uncompressTable(y,h),v.kerningPairs=kern.parse(e.data,e.offset)):v.kerningPairs={},u&&(S=uncompressTable(y,u),v.tables.gdef=gdef.parse(S.data,S.offset)),l&&(t=uncompressTable(y,l),v.tables.gpos=gpos.parse(t.data,t.offset),v.position.init()),p&&(e=uncompressTable(y,p),v.tables.gsub=gsub.parse(e.data,e.offset)),s&&(S=uncompressTable(y,s),v.tables.fvar=fvar.parse(S.data,S.offset,v.names)),g&&(t=uncompressTable(y,g),v.tables.meta=meta.parse(t.data,t.offset),v.metas=v.tables.meta),v}function load(e,o,s){s=null==s?{}:s;var t="undefined"==typeof window&&!s.isUrl?loadFromFile:loadFromUrl;return new Promise(function(a,n){t(e,function(e,t){if(e){if(o)return o(e);n(e)}var r;try{r=parseBuffer(t,s)}catch(e){if(o)return o(e,null);n(e)}if(o)return o(null,r);a(r)})})}var DEFAULT_OPTIONS={duration:1e3,"timing-function":"linear","iteration-count":1,direction:"normal","fill-mode":"forwards",delay:0,mode:"sync"},DEFAULT_STROKE={stroke:"#000","stroke-width":"1px","font-size":72},Tools=function(){},AnimationCreator=(Tools.deepCopy=function(t,r){var e,a,n=this;return void 0===r&&(r=[]),null===t||"object"!=typeof t?t:(e=function(e){return e.original===t},(e=r.filter(e)[0])?e.copy:(a=Array.isArray(t)?[]:{},r.push({original:t,copy:a}),Object.keys(t).forEach(function(e){a[e]=n.deepCopy(t[e],r)}),a))},function(e){this.options=Tools.deepCopy(this.formatOptions(DEFAULT_OPTIONS)),this.svgDom=null,this.setOptions(e)}),CSSCreator=(AnimationCreator.prototype.setSVGDom=function(e){this.svgDom=e,this.paths=e.querySelectorAll("path")},AnimationCreator.prototype.setOptions=function(e){return Object.assign(this.options,this.formatOptions(e)),this},AnimationCreator.prototype.setAllPathsAnimation=function(){var r=this;this.paths.forEach(function(e,t){r.setPathStroke(e),r.setPathAnimation(e,t)})},AnimationCreator.prototype.setPathStroke=function(e){var t=Math.ceil(e.getTotalLength());e.style.cssText+="stroke-dasharray:"+(t-1)+" "+(t+1)+";stroke-dashoffset:"+t+";"},AnimationCreator.prototype.setSVGAnimation=function(){console.error(this.constructor.name+" do not have setSVGAnimation method.")},AnimationCreator.prototype.setPathAnimation=function(e,t){console.error(this.constructor.name+" do not have setPathAnimation method.")},AnimationCreator.prototype.formatOptions=function(e){console.error(this.constructor.name+" do not have setPathAnimation method.")},AnimationCreator.prototype.create=function(e){return this.setSVGDom(e),this.setSVGAnimation(),this.setAllPathsAnimation(),e},function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.setSVGAnimation=function(){var e=this.svgDom.querySelector("style");null!=e?e.innerHTML="":e=document.createElement("style"),e.innerHTML="@keyframes STAdraw{to{stroke-dashoffset:0;fill-opacity:1;}}",this.svgDom.appendChild(e)},e.prototype.setPathAnimation=function(e,t){var r="",a=this.options;switch(a.mode){case"sync":r="animation: STAdraw "+a.duration+"ms "+a["timing-function"]+" 0ms "+a["fill-mode"]+" "+a.direction+" "+a["iteration-count"]+";";break;case"delay":r="animation: STAdraw "+a.duration+"ms "+a["timing-function"]+" "+a.delay*t+"ms "+a["fill-mode"]+" "+a.direction+" "+a["iteration-count"]+";";break;case"onebyone":r="animation: STAdraw "+a.duration+"ms "+a["timing-function"]+" "+a.duration*t+"ms "+a["fill-mode"]+" "+a.direction+" "+a["iteration-count"]+";"}e.style.cssText+=r},e.prototype.formatOptions=function(e){return e},e}(AnimationCreator)),SVGCreator=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.setSVGAnimation=function(){},e.prototype.setPathAnimation=function(e,t){var r=this.options,a=document.createElementNS("http://www.w3.org/2000/svg","animate");switch(a.setAttributeNS(null,"attributeName","stroke-dashoffset"),a.setAttributeNS(null,"to","0"),a.setAttributeNS(null,"dur",r.duration+"ms"),a.setAttributeNS(null,"calcMode",r["timing-function"]),a.setAttributeNS(null,"repeatCount",r["iteration-count"]),a.setAttributeNS(null,"fill",r["fill-mode"]),r.mode){case"sync":a.setAttributeNS(null,"begin","0ms");break;case"delay":a.setAttributeNS(null,"begin",r.delay*(t+1)+"ms");break;case"onebyone":a.setAttributeNS(null,"begin",r.duration*t+"ms");break;default:a.setAttributeNS(null,"begin",r.mode)}var n=a.cloneNode();n.setAttributeNS(null,"attributeName","fill-opacity"),n.setAttributeNS(null,"to","1"),e.appendChild(a),e.appendChild(n)},e.prototype.formatOptions=function(e){if(e)return e["timing-function"]&&(e["timing-function"]="linear"),"infinite"==e["iteration-count"]&&(e["iteration-count"]="indefinite"),e["fill-mode"]&&("none"==e["fill-mode"]?e["fill-mode"]="remove":e["fill-mode"]="freeze"),e},e}(AnimationCreator),SVGTextAnimate=function(e,t,r,a){this.loaded=!1,this.fontfile=e,this.creator=new("svg"===a?SVGCreator:CSSCreator)(t),this.stroke=Tools.deepCopy(DEFAULT_STROKE),this.setStroke(r),this.fatherdom=null};SVGTextAnimate.prototype.setFont=function(e){var n=this;return new Promise(function(r,a){load(e||n.fontfile,function(e,t){e?(console.error("font could not be loaded :("),a()):(n.font=t,n.loaded=!0,r(!0))})}).catch(function(e){console.log("catch:",e)})},SVGTextAnimate.prototype.setFontFromBuffer=function(e){return this.font=parseBuffer(e),this.loaded=!0,this},SVGTextAnimate.prototype.setOptions=function(e){return this.creator.setOptions(e),this},SVGTextAnimate.prototype.setStroke=function(e){return Object.assign(this.stroke,e),this},SVGTextAnimate.prototype.getBounding=function(e){return 0==e.length?(console.error("path does not exist"),{x1:0,y1:0,x2:0,y2:0}):{x1:0,y1:0,x2:e[e.length-1].getBoundingBox().x2,y2:e.reduce(function(e,t){return e.getBoundingBox().y2>=t.getBoundingBox().y2?e:t}).getBoundingBox().y2}},SVGTextAnimate.prototype.create=function(e,t){if(this.loaded)return t=document.querySelector(t),e=this.createSVGDom(e),t.innerHTML="",t.appendChild(e),this;console.error("Fontfile does not loaded")},SVGTextAnimate.prototype.add=function(e,t){if(this.loaded){t=document.querySelector(t);if(null!=t)return e=this.createSVGDom(e),t.appendChild(e),this;console.error("no such fatherdom")}else console.error("Fontfile does not loaded")},SVGTextAnimate.prototype.createSVGDom=function(e){var t=null,r="",a=document.createElement("div"),e=this.font.getPaths(e,0,this.stroke["font-size"],this.stroke["font-size"]),n=this.getBounding(e),o=this.stroke["stroke-width"].search(/[A-Za-z]+$/),o=Number(this.stroke["stroke-width"].substring(0,o)),n='<svg width="'+(n.x2-n.x1+o)+'" \n            height="'+(n.y2-n.y1)+'" \n            viewBox="'+n.x1+" "+n.y1+" "+(n.x2+o)+" "+(n.y2+o)+'"\n            xmlns="http://www.w3.org/2000/svg" style="vertical-align: text-top; ">\n          <g id="svgGroup" stroke-linecap="round" stroke="#000" fill='+this.stroke["fill-color"]+' style="fill:'+this.stroke["fill-color"]+"; fill-opacity:0;\n            stroke:"+this.stroke.stroke+";\n            stroke-width:"+this.stroke["stroke-width"]+';">\n          </g>\n      </svg>';return a.innerHTML=n,t=a.querySelector("svg"),e.forEach(function(e){r+=e.toSVG(2)}),t.querySelector("g").innerHTML=r,this.creator.create(t)};export{SVGTextAnimate as default};